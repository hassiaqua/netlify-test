{"componentChunkName":"component---src-templates-post-js","path":"/wp-cli/","result":{"data":{"wordpressPost":{"id":"a0c1b634-e678-51c7-baea-b85948202cc9","title":"WP-CLIで面倒なWordPressの初期設定をやってしまおう！※ Local by Flywheelを使う前提","slug":"wp-cli","content":"<p>わたしはWordPress案件をメインにフリーで活動しているのですが、WordPress案件をいただいた時に必ずローカル環境を作成します。</p>\n<p>ローカル環境の構築に使うのが「<a href=\"https://haniwaman.com/local-by-flywheel/\">Local by Flywheel</a>」です。WordPressの面倒なインストール作業を全部省いて使える状態まで持っていってくれるので、重宝しまくっているのですが、不満が点が1つだけ。</p>\n<p><strong class=\"marker\">英語の環境でインストールされるということ&#8230;</strong></p>\n<p>そんな不満を抱えながら何十件とローカル環境を構築しては、<strong>管理画面の設定から手で直す</strong>ということを繰り替えしていただのですが、ついにこのストレスから解消される方法を見つけました！</p>\n<p>それは、<span class=\"font-ll\">WP-CLIを使うこと</span>です。</p>\n<p>cliなので黒い画面のコマンドへの入力になるのですが、やることは<strong>コピペ</strong>です。「Local by Flywheel」ではWP-CLIが標準で使えるのも素晴らしいです。</p>\n<p>普段「Local by Flywheel」で環境構築している方は、ぜひお試しください！初期設定がめっちゃ楽になります。</p>\n<div class=\"chat\"><figure class=\"chat-img\"><img src=\"https://haniwaman.com/wp-content/themes/hpcode/img/haniwa.png\" alt=\"\"><figcaption>はにわまん</figcaption></figure><div class=\"chat-content\">これから紹介するWP-CLIのコマンドをコピペするだけでOKです</div></div>\n<div id=\"toc_container\" class=\"no_bullets\"><p class=\"toc_title\">目次</p><ul class=\"toc_list\"><li><a href=\"#WP-CLI\"><span class=\"toc_number toc_depth_1\">1</span> WP-CLIを使ってみる</a></li><li><a href=\"#WordPressWordPress\"><span class=\"toc_number toc_depth_1\">2</span> 英語WordPressを日本語WordPressにする</a></li><li><a href=\"#WP-CLI-2\"><span class=\"toc_number toc_depth_1\">3</span> 初期設定のあれこれをWP-CLIで楽に！</a><ul><li><a href=\"#i\"><span class=\"toc_number toc_depth_2\">3.1</span> 不要な記事を削除</a></li><li><a href=\"#i-2\"><span class=\"toc_number toc_depth_2\">3.2</span> 日本語のコアアップデート</a></li><li><a href=\"#i-3\"><span class=\"toc_number toc_depth_2\">3.3</span> プラグインのインストール</a></li><li><a href=\"#i-4\"><span class=\"toc_number toc_depth_2\">3.4</span> 最後に翻訳</a></li></ul></li><li><a href=\"#i-5\"><span class=\"toc_number toc_depth_1\">4</span> 「&amp;&amp;」で繋げば一気に実行できる</a></li><li><a href=\"#i-6\"><span class=\"toc_number toc_depth_1\">5</span> おわり</a></li></ul></div>\n<h2><span id=\"WP-CLI\">WP-CLIを使ってみる</span></h2>\n<p>とりあえず、WP-CLIを使ってみましょう。プログラムの「Hello World!」的ポジションの、コマンドのバージョン表示をやってみましょう。</p>\n<p>「Local by Flywheel」から操作したいサイトを右クリックして「Open Site SSH」を開きます。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2018/11/wp-cli.png\" alt=\"\" class=\"alignnone size-full wp-image-10136\" /></p>\n<p>こんな感じでコマンドプロンプトが開きます（windowsの場合）<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2018/11/wp-cli4-700x365.png\" alt=\"\" class=\"alignnone size-medium wp-image-10146\" srcset=\"https://haniwaman.com/wp-content/uploads/2018/11/wp-cli4-700x365.png 700w, https://haniwaman.com/wp-content/uploads/2018/11/wp-cli4-768x401.png 768w, https://haniwaman.com/wp-content/uploads/2018/11/wp-cli4-1200x626.png 1200w, https://haniwaman.com/wp-content/uploads/2018/11/wp-cli4.png 1468w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<p><code>wp cli version</code>を入力して、以下のような表示になればOKです！</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-0\">コピー</span><code id=\"code-0\" class=\"cli nohighlight hljs\">wp cli version\r\nWP-CLI 1.4.1\r\n</code></pre>\n<h2><span id=\"WordPressWordPress\">英語WordPressを日本語WordPressにする</span></h2>\n<p>「Local by Flywheel」でインストールされるWordPressは英語バージョンのWordPressです。こんな感じですね。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2018/11/wp-cli2-700x384.png\" alt=\"\" class=\"alignnone size-medium wp-image-10141\" srcset=\"https://haniwaman.com/wp-content/uploads/2018/11/wp-cli2-700x384.png 700w, https://haniwaman.com/wp-content/uploads/2018/11/wp-cli2-768x421.png 768w, https://haniwaman.com/wp-content/uploads/2018/11/wp-cli2-1200x658.png 1200w, https://haniwaman.com/wp-content/uploads/2018/11/wp-cli2.png 1326w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<p>いつもは、設定の「Site Language」と「Timezone」を手で変更していたんですが、これがまあ面倒くさい（項目多すぎる&#8230;）</p>\n<p>WP-CLIを使えば、ここの手作業を省けます。</p>\n<p>「Site Language」に対応しているのは、<code>wp core language install ja --activate</code></p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-1\">コピー</span><code id=\"code-1\" class=\"cli nohighlight hljs\">wp core language install ja --activate\r\nDownloading translation from https://downloads.wordpress.org/translation/core/4.9.8/ja.zip...\r\nUnpacking the update...\r\nInstalling the latest version...\r\nTranslation updated successfully.\r\nSuccess: Language installed.\r\nSuccess: Language activated.\r\n</code></pre>\n<p>「Timezone」に対応しているのは、<code>wp option update timezone_string 'Asia/Tokyo'</code></p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-2\">コピー</span><code id=\"code-2\" class=\"cli nohighlight hljs\">wp option update timezone_string 'Asia/Tokyo'\r\nSuccess: Updated 'timezone_string' option.\r\n</code></pre>\n<p>この2つ実行後のWordPress管理画面を確認してみると、、、<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2018/11/wp-cli3-700x368.png\" alt=\"\" class=\"alignnone size-medium wp-image-10144\" srcset=\"https://haniwaman.com/wp-content/uploads/2018/11/wp-cli3-700x368.png 700w, https://haniwaman.com/wp-content/uploads/2018/11/wp-cli3-768x404.png 768w, https://haniwaman.com/wp-content/uploads/2018/11/wp-cli3-1200x631.png 1200w, https://haniwaman.com/wp-content/uploads/2018/11/wp-cli3.png 1573w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<p>わたしたちが見慣れた日本語のWordPressに変わっていますね！</p>\n<p>日付や時刻のフォーマットも変更可能です。</p>\n<p>日付のフォーマット</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-3\">コピー</span><code id=\"code-3\" class=\"cli nohighlight hljs\">wp option update date_format 'Y-m-d'\r\nSuccess: Updated 'date_format' option.\r\n</code></pre>\n<p>時刻のフォーマット</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-4\">コピー</span><code id=\"code-4\" class=\"cli nohighlight hljs\">wp option update time_format 'H:i'\r\nSuccess: Updated 'time_format' option.\r\n</code></pre>\n<p>これでわたしの目的の大半は達成していますが、ついでに色々やっていきましょう。</p>\n<h2><span id=\"WP-CLI-2\">初期設定のあれこれをWP-CLIで楽に！</span></h2>\n<p>ついでに面倒な初期設定をWP-CLIで色々やっていきましょう！</p>\n<h3><span id=\"i\">不要な記事を削除</span></h3>\n<p>投稿や固定ページを合わせると3記事がデフォルトで入っています。これはいつも手で削除していたので、コマンドで消しちゃいましょう。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-5\">コピー</span><code id=\"code-5\" class=\"cli nohighlight hljs\">wp post delete 1 2 3 --force\r\nSuccess: Deleted post 1.\r\nSuccess: Deleted post 2.\r\nSuccess: Deleted post 3.\r\n</code></pre>\n<p><code>--force</code>を付けることでゴミ箱にも残らずに消え去ります。</p>\n<p>投稿も固定も記事がなくなりました。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2018/11/wp-cli5-700x366.png\" alt=\"\" class=\"alignnone size-medium wp-image-10151\" srcset=\"https://haniwaman.com/wp-content/uploads/2018/11/wp-cli5-700x366.png 700w, https://haniwaman.com/wp-content/uploads/2018/11/wp-cli5-768x402.png 768w, https://haniwaman.com/wp-content/uploads/2018/11/wp-cli5.png 1020w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<h3><span id=\"i-2\">日本語のコアアップデート</span></h3>\n<p>日本語化すると、バージョンが古いままになってしまうことがあります（英語は最新だけど、日本語は1つ前みたいな）</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-6\">コピー</span><code id=\"code-6\" class=\"cli nohighlight hljs\">wp core update --locale=ja --force\r\n（中略）\r\nSuccess: WordPress updated successfully.\r\n</code></pre>\n<p>最新版となりました！<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2018/11/wp-cli6-700x290.png\" alt=\"\" class=\"alignnone size-medium wp-image-10152\" srcset=\"https://haniwaman.com/wp-content/uploads/2018/11/wp-cli6-700x290.png 700w, https://haniwaman.com/wp-content/uploads/2018/11/wp-cli6-768x318.png 768w, https://haniwaman.com/wp-content/uploads/2018/11/wp-cli6-1200x498.png 1200w, https://haniwaman.com/wp-content/uploads/2018/11/wp-cli6.png 1382w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<h3><span id=\"i-3\">プラグインのインストール</span></h3>\n<p>お決まりのプラグインはWP-CLIで入れて「有効化」までしておきましょう。</p>\n<p>以下のプラグインを入れていきます。</p>\n<ul>\n<li>WP Multibyte Patch</li>\n<li>Show Current Template</li>\n<li>Duplicate Post</li>\n<li>All-in-One WP Migration</li>\n</ul>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-7\">コピー</span><code id=\"code-7\" class=\"cli nohighlight hljs\">wp plugin install wp-multibyte-patch show-current-template duplicate-post all-in-one-wp-migration --activate\r\n（中略）\r\nSuccess: Installed 4 of 4 plugins.\r\n</code></pre>\n<p>4つのプラグインが有効化まで完了しましたー！<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2018/11/wp-cli7-700x460.png\" alt=\"\" class=\"alignnone size-medium wp-image-10155\" srcset=\"https://haniwaman.com/wp-content/uploads/2018/11/wp-cli7-700x460.png 700w, https://haniwaman.com/wp-content/uploads/2018/11/wp-cli7-768x505.png 768w, https://haniwaman.com/wp-content/uploads/2018/11/wp-cli7-1200x788.png 1200w, https://haniwaman.com/wp-content/uploads/2018/11/wp-cli7.png 1280w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<p><code>--activate</code>のオプションを付けることで有効化までしてくれるようになります。</p>\n<p>ちなみに、プラグインとして指定する値は、公式ページのスラッグに該当する部分です。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2018/11/wp-cli9.png\" alt=\"\" class=\"alignnone size-full wp-image-10165\" /></p>\n<h3><span id=\"i-4\">最後に翻訳</span></h3>\n<p>プラグインをインストールすると、翻訳の更新が求められます。すべてのコマンドをやった最後に翻訳のアップデートをしておくといいかと思います。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-8\">コピー</span><code id=\"code-8\" class=\"cli nohighlight hljs\">wp core language update\r\n（中略）\r\nSuccess: Updated 4/4 translations.\r\n</code></pre>\n<p>翻訳も最新版になりました。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2018/11/wp-cli8-700x327.png\" alt=\"\" class=\"alignnone size-medium wp-image-10156\" srcset=\"https://haniwaman.com/wp-content/uploads/2018/11/wp-cli8-700x327.png 700w, https://haniwaman.com/wp-content/uploads/2018/11/wp-cli8-768x359.png 768w, https://haniwaman.com/wp-content/uploads/2018/11/wp-cli8.png 904w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<h2><span id=\"i-5\">「&amp;&amp;」で繋げば一気に実行できる</span></h2>\n<p>現時点でめっちゃ楽なんですけど、できることなら全部一発でやりたいなって思います。これを実現してくれるのが、「&amp;&amp;」</p>\n<p>これまで紹介したコマンドを「&amp;&amp;」で繋ぐと一気に全部やってくれます。別の作業やっている間に環境の初期設定が完了しちゃうわけですね。素晴らしい&#8230;</p>\n<p>ちなみに全部繋ぐとこんな感じになります（長い&#8230;笑）</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-9\">コピー</span><code id=\"code-9\" class=\"cli nohighlight hljs\">wp post delete 1 2 3 --force &amp;&amp; wp core language install ja --activate &amp;&amp; wp option update timezone_string 'Asia/Tokyo' &amp;&amp; wp core update --locale=ja --force &amp;&amp; wp plugin install wp-multibyte-patch show-current-template duplicate-post all-in-one-wp-migration --activate &amp;&amp; wp core language update\r\n</code></pre>\n<h2><span id=\"i-6\">おわり</span></h2><div class=\"matome\"><div class=\"matome-img\"><img src=\"https://haniwaman.com/wp-content/themes/hpcode/img/haniwa.png\" alt=\"\"></div><div class=\"matome-twitter\"><a href=\"https://twitter.com/haniwa008?ref_src=twsrc%5Etfw\" class=\"twitter-follow-button\" data-show-screen-name=\"false\" data-size=\"large\" data-lang=\"ja\" data-show-count=\"true\">Follow @haniwa008</a><script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script></div></div><!-- /matome -->\n<p><strong class=\"marker\">「Local by Flywheel」で環境構築している方は、WP-CLIを使うと楽に設定できる</strong>というお話でした！</p>\n<p>特に英語の日本語化の部分はストレス溜まっていた部分なので、解消できてよかったです。やっぱり機械に任せられる箇所はどんどんと自動化させていくべきですね&#8230;</p>\n","date":"November 01, 2018","categories":[{"name":"WordPress","slug":"wordpress"}],"tags":null,"author":{"name":"はにわまん","slug":"haniwaman"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"id":"a0c1b634-e678-51c7-baea-b85948202cc9"}}}