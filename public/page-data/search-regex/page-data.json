{"componentChunkName":"component---src-templates-post-js","path":"/search-regex/","result":{"data":{"wordpressPost":{"id":"fb1e2a3e-f7ff-507a-85bb-fdd0acb4575e","title":"WordPressの記事内コンテンツを一括置換できる「Search Regex」","slug":"search-regex","content":"<p>WordPressの記事内コンテンツを一括置換できるプラグイン「Search Regex」の紹介です。</p>\n<p>個人的には主にURLの置換で使うことが多いかと思います。</p>\n<div class=\"chat\"><figure class=\"chat-img\"><img src=\"https://haniwaman.com/wp-content/themes/hpcode/img/haniwa.png\" alt=\"\"><figcaption>はにわまん</figcaption></figure><div class=\"chat-content\">頻繁には使いませんが、知っておくと役立つ日はくるかと思います。</div></div>\n<div id=\"toc_container\" class=\"no_bullets\"><p class=\"toc_title\">目次</p><ul class=\"toc_list\"><li><a href=\"#Search_Regex\"><span class=\"toc_number toc_depth_1\">1</span> Search Regexのインストール</a></li><li><a href=\"#Search_Regex-2\"><span class=\"toc_number toc_depth_1\">2</span> Search Regexの使い方</a><ul><li><a href=\"#URLhttphttps\"><span class=\"toc_number toc_depth_2\">2.1</span> URLをhttpからhttpsに変更</a></li><li><a href=\"#i\"><span class=\"toc_number toc_depth_2\">2.2</span> 正規表現の使い方</a></li><li><a href=\"#i-2\"><span class=\"toc_number toc_depth_2\">2.3</span> カスタム投稿タイプにも適応させたい場合</a></li><li><a href=\"#i-3\"><span class=\"toc_number toc_depth_2\">2.4</span> ウィジェットやメニューは適応されない</a></li></ul></li><li><a href=\"#Search_Regex-3\"><span class=\"toc_number toc_depth_1\">3</span> Search Regexの使いどころ</a><ul><li><a href=\"#https\"><span class=\"toc_number toc_depth_2\">3.1</span> https化</a></li><li><a href=\"#i-4\"><span class=\"toc_number toc_depth_2\">3.2</span> ドメイン変更</a></li></ul></li><li><a href=\"#i-5\"><span class=\"toc_number toc_depth_1\">4</span> おわり</a></li></ul></div>\n<h2><span id=\"Search_Regex\">Search Regexのインストール</span></h2>\n<p>プラグイン → 新規追加 → キーワード「Search Regex」<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2019/02/search-regex-700x215.png\" alt=\"\" class=\"alignnone size-medium wp-image-13526\" srcset=\"https://haniwaman.com/wp-content/uploads/2019/02/search-regex-700x215.png 700w, https://haniwaman.com/wp-content/uploads/2019/02/search-regex-768x236.png 768w, https://haniwaman.com/wp-content/uploads/2019/02/search-regex-1200x369.png 1200w, https://haniwaman.com/wp-content/uploads/2019/02/search-regex.png 1969w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<p>「有効化」しておきます。<br />\n<img width=\"420\" src=\"https://haniwaman.com/wp-content/uploads/2019/02/search-regex2-700x275.png\" alt=\"\" class=\"alignnone size-medium wp-image-13527\" srcset=\"https://haniwaman.com/wp-content/uploads/2019/02/search-regex2-700x275.png 700w, https://haniwaman.com/wp-content/uploads/2019/02/search-regex2-768x301.png 768w, https://haniwaman.com/wp-content/uploads/2019/02/search-regex2.png 968w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<h2><span id=\"Search_Regex-2\">Search Regexの使い方</span></h2>\n<p>ツール → Search Regex を開きます。<br />\n<img width=\"200\" src=\"https://haniwaman.com/wp-content/uploads/2019/02/search-regex3.png\" alt=\"\" class=\"alignnone size-full wp-image-13528\" /></p>\n<p>3つのボタンがあります。それぞれ以下のような意味になります。</p>\n<div class=\"box\">\n<ul>\n<li>Search ・・・ 該当するキーワードが存在するかチェック</li>\n<li>Replace ・・・　該当するキーワードがどのように置き換わるかチェック（保存はされない）</li>\n<li>Replace &amp; Save ・・・ 該当するキーワードを置き換えて一括で保存</li>\n</ul>\n</div>\n<p>置換する流れとしては、「Search」でちゃんとヒットするか確認して、「Replace」でどのように置き換わるか確認（ちゃんと意図通りに置換できそうか確認）して、問題なさそうなら「Replace &amp; Save」で置換 &amp; 保存するようなイメージです。</p>\n<h3><span id=\"URLhttphttps\">URLをhttpからhttpsに変更</span></h3>\n<p>httpのサイトをhttpsに置換する時によく使われたりするので、この実例で見ていきましょう。</p>\n<p>それぞれの入力項目は以下のようになります。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2019/02/search-regex5-700x282.png\" alt=\"\" class=\"alignnone size-medium wp-image-13530\" srcset=\"https://haniwaman.com/wp-content/uploads/2019/02/search-regex5-700x282.png 700w, https://haniwaman.com/wp-content/uploads/2019/02/search-regex5-768x310.png 768w, https://haniwaman.com/wp-content/uploads/2019/02/search-regex5.png 1197w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<table class=\"table\">\n<tr>\n<th width=\"120\">Source</th>\n<td>どのコンテンツを置換の対象にするか。タイトルなども選べますが、基本的には投稿コンテンツ（Post content）だと思います。</td>\n</tr>\n<tr>\n<th>Search pattern</th>\n<td>置換前の文字列（正規表現もあり）</td>\n</tr>\n<tr>\n<th>Replace pattern</th>\n<td>置換後の文字列（正規表現もあり）</td>\n</tr>\n<tr>\n<th>Regex</th>\n<td>正規表現を使うかどうか</td>\n</tr>\n</table>\n<h4>「Search」ボタンの挙動</h4>\n<p>した記事の箇所が一覧で表示されます。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2019/02/search-regex6-700x218.png\" alt=\"\" class=\"alignnone size-medium wp-image-13531\" srcset=\"https://haniwaman.com/wp-content/uploads/2019/02/search-regex6-700x218.png 700w, https://haniwaman.com/wp-content/uploads/2019/02/search-regex6-768x239.png 768w, https://haniwaman.com/wp-content/uploads/2019/02/search-regex6-1200x373.png 1200w, https://haniwaman.com/wp-content/uploads/2019/02/search-regex6.png 1943w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<h4>「Replace」ボタンの挙動</h4>\n<p>「Search pattern」にマッチした記事の箇所と、そこを「Replace pattern」で入力した値に置換したときにどのように変更されるかが並んで表示されます。<br />\n※ 保存はまだされていない。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2019/02/search-regex7-700x303.png\" alt=\"\" class=\"alignnone size-medium wp-image-13532\" srcset=\"https://haniwaman.com/wp-content/uploads/2019/02/search-regex7-700x303.png 700w, https://haniwaman.com/wp-content/uploads/2019/02/search-regex7-768x332.png 768w, https://haniwaman.com/wp-content/uploads/2019/02/search-regex7-1200x519.png 1200w, https://haniwaman.com/wp-content/uploads/2019/02/search-regex7.png 1960w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<h4>「Replace &amp; Save」の挙動</h4>\n<p>実際に「Search pattern」にマッチした箇所が、「Replace pattern」に<strong class=\"marker\">書き換えられて一括で保存</strong>されます。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2019/02/search-regex8-700x277.png\" alt=\"\" class=\"alignnone size-medium wp-image-13533\" srcset=\"https://haniwaman.com/wp-content/uploads/2019/02/search-regex8-700x277.png 700w, https://haniwaman.com/wp-content/uploads/2019/02/search-regex8-768x304.png 768w, https://haniwaman.com/wp-content/uploads/2019/02/search-regex8.png 1181w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<p>有無を言わさず保存されるので、まずは「Replace」ボタンでどのように置換されるか、ちゃんと確認しておいた方がいいかと思います。</p>\n<h3><span id=\"i\">正規表現の使い方</span></h3>\n<p>「Regex」の右側にチェックを入れることで、正規表現を使うことができます。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2019/02/search-regex9-700x228.png\" alt=\"\" class=\"alignnone size-medium wp-image-13534\" srcset=\"https://haniwaman.com/wp-content/uploads/2019/02/search-regex9-700x228.png 700w, https://haniwaman.com/wp-content/uploads/2019/02/search-regex9-768x250.png 768w, https://haniwaman.com/wp-content/uploads/2019/02/search-regex9.png 1178w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<p>例として、<code>h3</code>の見出しを<code>h4</code>に変更する、みたいな処理を行っていきます。書き方としては以下のようになるかと思います。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2019/02/search-regex10-700x275.png\" alt=\"\" class=\"alignnone size-medium wp-image-13536\" srcset=\"https://haniwaman.com/wp-content/uploads/2019/02/search-regex10-700x275.png 700w, https://haniwaman.com/wp-content/uploads/2019/02/search-regex10-768x301.png 768w, https://haniwaman.com/wp-content/uploads/2019/02/search-regex10-1200x471.png 1200w, https://haniwaman.com/wp-content/uploads/2019/02/search-regex10.png 1206w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<p>「Search pattern」にはマッチさせる対象の正規表現を作ります。JavaScriptやPHPで書く時と同様に前後に「正規表現使ってますよ」の区切り文字？みたいなものが必要です。カッコにした箇所は置換後に変数として使えるようになる箇所です。</p>\n<p>「Search pattern」 → <code>|&lt;h3&gt;(.*?)&lt;/h3&gt;|</code></p>\n<p>「Replace pattern」には、文字列と「Search pattern」から受け取る変数で構成される感じです。<code>(.*?)</code>の箇所は<code>$1</code>として受け取ることができます。<br />\n※ カッコが複数ある場合は、カッコの出現順に$○の番号が決まるイメージです。</p>\n<p>「Replace pattern」 → <code>&lt;h4&gt;$1&lt;/h4&gt;</code></p>\n<p>Replaceボタンを教えてみましょう。いい感じで意図通り置換できそうです。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2019/02/search-regex11-700x376.png\" alt=\"\" class=\"alignnone size-medium wp-image-13537\" srcset=\"https://haniwaman.com/wp-content/uploads/2019/02/search-regex11-700x376.png 700w, https://haniwaman.com/wp-content/uploads/2019/02/search-regex11-768x412.png 768w, https://haniwaman.com/wp-content/uploads/2019/02/search-regex11-1200x644.png 1200w, https://haniwaman.com/wp-content/uploads/2019/02/search-regex11.png 1959w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<h3><span id=\"i-2\">カスタム投稿タイプにも適応させたい場合</span></h3>\n<p>標準の仕組みとしてはないので、、プラグインを直接編集する必要があります。対象のファイルは、<span class=\"filename\">searches/post_content.php</span>です。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2019/02/search-regex4-700x291.png\" alt=\"\" class=\"alignnone size-medium wp-image-13529\" srcset=\"https://haniwaman.com/wp-content/uploads/2019/02/search-regex4-700x291.png 700w, https://haniwaman.com/wp-content/uploads/2019/02/search-regex4-768x319.png 768w, https://haniwaman.com/wp-content/uploads/2019/02/search-regex4-1200x499.png 1200w, https://haniwaman.com/wp-content/uploads/2019/02/search-regex4.png 1950w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-0\">コピー</span><code id=\"code-0\" class=\"php\">$sql = \"SELECT ID, post_content, post_title FROM {$wpdb-&gt;posts} WHERE post_status != 'inherit' AND post_type IN ('post','page') ORDER BY ID \".$orderby;</code></pre>\n<p>修正するのは、<code>IN ('post','page')</code>のカッコの中で、ここに任意のカスタム投稿タイプ名を追加してあげればOKです。例えば「news」という投稿タイプを追加するなら、以下のようになります。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-1\">コピー</span><code id=\"code-1\" class=\"php\">$sql = \"SELECT ID, post_content, post_title FROM {$wpdb-&gt;posts} WHERE post_status != 'inherit' AND post_type IN ('post','page','news') ORDER BY ID \".$orderby;</code></pre>\n<h3><span id=\"i-3\">ウィジェットやメニューは適応されない</span></h3>\n<p>「Search Regex」が置換の対象とするのは、投稿コンテンツが基本となります。</p>\n<p><strong class=\"marker\">ウィジェットやメニューには適応されない</strong>ので、こちらにも書き換え対象の文字がある場合はチェックを忘れないようにしなければいけません。</p>\n<h2><span id=\"Search_Regex-3\">Search Regexの使いどころ</span></h2>\n<p>Search Regexの具体的な使い所ですが、大きくは2パターンあるかと思います。</p>\n<h3><span id=\"https\">https化</span></h3>\n<p>この記事でも置換の具体例として紹介しましたが、https化の流れがあって一躍有名になったのが「Search Regex」でした。</p>\n<p>特に投稿数の多いサイトだとhttp → httpsっていう更新を全記事に対して行うのが手間すぎるので、こういうプラグインを使って一括で置換させることで楽ができます。</p>\n<p>https化の流れは以下の記事で紹介しています。</p>\n<blockquote class=\"wp-embedded-content\" data-secret=\"xKtZ44jLWB\"><p><a href=\"https://haniwaman.com/wordpress-https/\">WordPressサイトをSSL（https化）する手順と確認ポイント</a></p></blockquote>\n<p><iframe title=\"&#8220;WordPressサイトをSSL（https化）する手順と確認ポイント&#8221; &#8212; HPcode\" class=\"wp-embedded-content\" sandbox=\"allow-scripts\" security=\"restricted\" style=\"position: absolute; clip: rect(1px, 1px, 1px, 1px);\" src=\"https://haniwaman.com/wordpress-https/embed/#?secret=xKtZ44jLWB\" data-secret=\"xKtZ44jLWB\" width=\"500\" height=\"282\" frameborder=\"0\" marginwidth=\"0\" marginheight=\"0\" scrolling=\"no\"></iframe></p>\n<h3><span id=\"i-4\">ドメイン変更</span></h3>\n<p>ドメインの変更を伴う引っ越しなどでも使われることが多いです。投稿コンテンツのインポート → 「Search Regex」でURLの置換 みたいな感じですかね。</p>\n<p>ただ、引っ越しにも使える「All-in-One WP Migration」プラグインもインポートするサイトのURLに応じて、いい感じでコンテンツ内のURLを置換してくれるので、こちらも検討してみるといいかもしれません。</p>\n<blockquote class=\"wp-embedded-content\" data-secret=\"udAF70l5s6\"><p><a href=\"https://haniwaman.com/all-in-one-wp-migration/\">WordPressのバックアップは「All-in-One WP Migration」でDBもテーマもオールOK！！</a></p></blockquote>\n<p><iframe title=\"&#8220;WordPressのバックアップは「All-in-One WP Migration」でDBもテーマもオールOK！！&#8221; &#8212; HPcode\" class=\"wp-embedded-content\" sandbox=\"allow-scripts\" security=\"restricted\" style=\"position: absolute; clip: rect(1px, 1px, 1px, 1px);\" src=\"https://haniwaman.com/all-in-one-wp-migration/embed/#?secret=udAF70l5s6\" data-secret=\"udAF70l5s6\" width=\"500\" height=\"282\" frameborder=\"0\" marginwidth=\"0\" marginheight=\"0\" scrolling=\"no\"></iframe></p>\n<p>アナログなわたしは、「Search Regex」だとちゃんと見ながらできるので、とても安心できたりします笑</p>\n<h2><span id=\"i-5\">おわり</span></h2><div class=\"matome\"><div class=\"matome-img\"><img src=\"https://haniwaman.com/wp-content/themes/hpcode/img/haniwa.png\" alt=\"\"></div><div class=\"matome-twitter\"><a href=\"https://twitter.com/haniwa008?ref_src=twsrc%5Etfw\" class=\"twitter-follow-button\" data-show-screen-name=\"false\" data-size=\"large\" data-lang=\"ja\" data-show-count=\"true\">Follow @haniwa008</a><script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script></div></div><!-- /matome -->\n<p>WordPressの記事内コンテンツを一括置換できる「Search Regex」の紹介でした。</p>\n<p>個人的にURL系の変更で使うことが多いかと思います。こういった補助系のプラグインも使えるようになっていると、自分のサイト運営の効率やWordPress案件の効率も上がってくると思います。</p>\n<p>頻繁に使われることはないプラグインですが、存在を知っておくと、必要になった時に楽ができるはずです！</p>\n","date":"February 10, 2019","categories":[{"name":"WordPress","slug":"wordpress"}],"tags":[{"name":"WordPressプラグイン","slug":"plugin"}],"author":{"name":"はにわまん","slug":"haniwaman"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"id":"fb1e2a3e-f7ff-507a-85bb-fdd0acb4575e"}}}