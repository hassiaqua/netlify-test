{"componentChunkName":"component---src-templates-post-js","path":"/page-paged/","result":{"data":{"wordpressPost":{"id":"1994dc3d-ad37-5e2c-b262-fc1213345cdc","title":"pageとpagedは違う！個別ページと一覧ページで使い分けよう","slug":"page-paged","content":"<p>WordPressでオリジナルな一覧ページを作る上で意識して指定しているのが、<code>paged</code>という値だと思います。</p>\n<p><code>WP_Query( array( 'paged' =&gt; $paged ) );</code>といった感じですね。</p>\n<p>この<code>$paged</code>の取得方法が一覧ページと個別ページで取得方法が異なるというお話になります。あまり情報もなく詰まると平気で数十時間を費やすつまずきポイントでもあるので、頭の片隅にでも残しておいてください！</p>\n<div id=\"toc_container\" class=\"no_bullets\"><p class=\"toc_title\">目次</p><ul class=\"toc_list\"><li><a href=\"#i\"><span class=\"toc_number toc_depth_1\">1</span> 一覧ページでのループ条件の作り方</a><ul><li><a href=\"#i-2\"><span class=\"toc_number toc_depth_2\">1.1</span> 一覧ページのテンプレートってどれ？</a></li></ul></li><li><a href=\"#i-3\"><span class=\"toc_number toc_depth_1\">2</span> 個別ページでのループ条件の作り方</a><ul><li><a href=\"#i-4\"><span class=\"toc_number toc_depth_2\">2.1</span> 個別ページのテンプレートってどれ？</a></li></ul></li><li><a href=\"#i-5\"><span class=\"toc_number toc_depth_1\">3</span> ページャーの指定も変える</a></li><li><a href=\"#i-6\"><span class=\"toc_number toc_depth_1\">4</span> おわり</a></li></ul></div>\n<h2><span id=\"i\">一覧ページでのループ条件の作り方</span></h2>\n<p>一覧ページでのループ条件を作るときは、いつもの方法と同じです。</p>\n<p>ループ情報の指定方法は以下の記事のサブループを参考にしていただければと思います。</p>\n<blockquote class=\"wp-embedded-content\" data-secret=\"FU51FIoCa0\"><p><a href=\"https://haniwaman.com/loop/\">WordPressの任意のループ（サブループ）を作る方法と覚えておきたい指定方法</a></p></blockquote>\n<p><iframe title=\"&#8220;WordPressの任意のループ（サブループ）を作る方法と覚えておきたい指定方法&#8221; &#8212; HPcode\" class=\"wp-embedded-content\" sandbox=\"allow-scripts\" security=\"restricted\" style=\"position: absolute; clip: rect(1px, 1px, 1px, 1px);\" src=\"https://haniwaman.com/loop/embed/#?secret=FU51FIoCa0\" data-secret=\"FU51FIoCa0\" width=\"500\" height=\"282\" frameborder=\"0\" marginwidth=\"0\" marginheight=\"0\" scrolling=\"no\"></iframe></p>\n<p>現在のページ番号を取得するには、<code>get_query_var( 'paged' )</code>という方法になります。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-0\">コピー</span><code id=\"code-0\" class=\"php\">$paged = ( get_query_var( 'paged' ) ) ? get_query_var( 'paged' ) : 1;\r\n$the_query = new WP_Query( array( 'post_type' =&gt; 'post', 'posts_per_page' =&gt; '10', 'paged' =&gt; $paged ) );</code></pre>\n<p>これが一般的なサブループの作り方です。</p>\n<h3><span id=\"i-2\">一覧ページのテンプレートってどれ？</span></h3>\n<p>「一覧ページは<code>get_query_var( 'paged' )</code>で書く！」と言われても、一覧ページって具体的にどれ？って思う方もいるかもしれません。</p>\n<ul>\n<li>page.php</li>\n<li>single.php</li>\n<li>front-page.php</li>\n</ul>\n<p><strong class=\"marker\">以外のテンプレート</strong>と捉えていただけたらと思います。archive.phpやhome.php、category.phpなどなど、多くのページは一覧用のページとなります。上記以外のテンプレートにループを記載するときは、<code>get_query_var( 'paged' )</code>でページ番号を取得するということですね。</p>\n<h2><span id=\"i-3\">個別ページでのループ条件の作り方</span></h2>\n<p>一方で個別ページでページ番号を取得するには、<code>get_query_var( 'page' )</code>で取得します。</p>\n<p>一覧ページと違いがないと思われるかもしれませんが、よく比べてみると引数の値が違います。<code>paged</code>か<code>page</code>の違いですね。</p>\n<table class=\"table\">\n<tr>\n<th width=\"120\">一覧ページ</th>\n<td><code>get_query_var( 'paged' )</code></td>\n</tr>\n<tr>\n<th>個別ページ</th>\n<td><code>get_query_var( 'page' )</code></td>\n</tr>\n</table>\n<p>個別ページでループするためのサブループを作るとすると、以下のようになります。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-1\">コピー</span><code id=\"code-1\" class=\"php\">$paged = ( get_query_var( 'paged' ) ) ? get_query_var( 'page' ) : 1;\r\n$the_query = new WP_Query( array( 'post_type' =&gt; 'post', 'posts_per_page' =&gt; '10', 'paged' =&gt; $paged ) );</code></pre>\n<h3><span id=\"i-4\">個別ページのテンプレートってどれ？</span></h3>\n<p>個別ページのテンプレートは、よく使うものだと以下のとおりです。</p>\n<ul>\n<li><span class=\"filename\">single.php</span></li>\n<li><span class=\"filename\">page.php</span></li>\n<li><span class=\"filename\">front-page.php</span></li>\n</ul>\n<p>個人的によく引っかかるのが、<span class=\"filename\">front-page.php</span>からループを作ろうとしたときですね。いつものように<code>get_query_var( 'paged' )</code>で書こうとすると<strong class=\"marker\">ページが遷移しない・・・</strong>という事態に出くわします。</p>\n<p>本来的には<span class=\"filename\">home.php</span>をトップページにしてループさせる事案なのかもしれませんが、、、</p>\n<p>トップページの指定方法については、以下を参考にしていただき、<span class=\"filename\">front-page.php</span>と<span class=\"filename\">home.php</span>の２つが必要かどうか検討すると思います。<span class=\"filename\">home.php</span>だけで十分ならいつものルールで大丈夫です。</p>\n<blockquote class=\"wp-embedded-content\" data-secret=\"qQ4gqIqh7l\"><p><a href=\"https://haniwaman.com/front-page/\">WordPressのトップページを任意のテンプレートで指定してブログ一覧を別にする方法</a></p></blockquote>\n<p><iframe title=\"&#8220;WordPressのトップページを任意のテンプレートで指定してブログ一覧を別にする方法&#8221; &#8212; HPcode\" class=\"wp-embedded-content\" sandbox=\"allow-scripts\" security=\"restricted\" style=\"position: absolute; clip: rect(1px, 1px, 1px, 1px);\" src=\"https://haniwaman.com/front-page/embed/#?secret=qQ4gqIqh7l\" data-secret=\"qQ4gqIqh7l\" width=\"500\" height=\"282\" frameborder=\"0\" marginwidth=\"0\" marginheight=\"0\" scrolling=\"no\"></iframe></p>\n<h2><span id=\"i-5\">ページャーの指定も変える</span></h2>\n<p>サブループ（<code>WP_Query</code>で作ったループ）で表現している場合は、ページャーの指定方法も気をつけないといけません。なぜなら<code>'current'</code>で<code>get_query_var()</code>が使われているからです。</p>\n<p>ページャーの表現は以下のような感じですね。<br />\n（参考：<a href=\"https://wpdocs.osdn.jp/%E9%96%A2%E6%95%B0%E3%83%AA%E3%83%95%E3%82%A1%E3%83%AC%E3%83%B3%E3%82%B9/paginate_links#.E3.82.AB.E3.82.B9.E3.82.BF.E3.83.A0.E3.82.AF.E3.82.A8.E3.83.AA.E3.82.92.E4.BD.BF.E7.94.A8.E3.81.97.E3.81.9F.E4.BE.8B\" rel=\"noopener\" target=\"_blank\">関数リファレンス/paginate links &#8211; WordPress Codex 日本語版</a>）</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-2\">コピー</span><code id=\"code-2\" class=\"php\">$big = 999999999;\r\necho paginate_links( array(\r\n\t'base'      =&gt; str_replace( $big, '%#%', esc_url( get_pagenum_link( $big ) ) ),\r\n\t'current'   =&gt; max( 1, get_query_var( 'paged' ) ),\r\n\t'total'     =&gt; $the_query-&gt;max_num_pages,\r\n\t'mid_size'  =&gt; 1,\r\n\t'end_size'  =&gt; 1,\r\n\t'prev_text' =&gt; '前',\r\n\t'next_text' =&gt; '次',\r\n\t'type'      =&gt; 'plane',\r\n) );</code></pre>\n<p>ループと同じように、一覧ページなら<code>paged</code>、個別ページなら<code>page</code>といった具合です。</p>\n<table class=\"table\">\n<tr>\n<th width=\"120\">一覧ページ</th>\n<td><code>'current' => max( 1, get_query_var( 'paged' ) )</code></td>\n</tr>\n<tr>\n<th>個別ページ</th>\n<td><code>'current' => max( 1, get_query_var( 'page' ) )</code></td>\n</tr>\n</table>\n<h2><span id=\"i-6\">おわり</span></h2><div class=\"matome\"><div class=\"matome-img\"><img src=\"https://haniwaman.com/wp-content/themes/hpcode/img/haniwa.png\" alt=\"\"></div><div class=\"matome-twitter\"><a href=\"https://twitter.com/haniwa008?ref_src=twsrc%5Etfw\" class=\"twitter-follow-button\" data-show-screen-name=\"false\" data-size=\"large\" data-lang=\"ja\" data-show-count=\"true\">Follow @haniwa008</a><script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script></div></div><!-- /matome -->\n<p>個別ページと一覧ページでループを回す時の<code>page</code>と<code>paged</code>の違いでした。こういう小さいことですが、本当に詰まります・・・。</p>\n<p>平気で１日とか費やすことになるので、わたしの過去の不幸を繰り返さないためにも頭の片隅に残しておいてください！</p>\n","date":"January 07, 2019","categories":[{"name":"WordPress","slug":"wordpress"}],"tags":null,"author":{"name":"はにわまん","slug":"haniwaman"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"id":"1994dc3d-ad37-5e2c-b262-fc1213345cdc"}}}