{"componentChunkName":"component---src-templates-post-js","path":"/vscode-wordpress-format/","result":{"data":{"wordpressPost":{"id":"0fdb6eb6-5329-5b3c-bbfb-46dedf6643f1","title":"VSCodeで「WordPress Coding Standards」に準拠してPHPの自動フォーマットする方法","slug":"vscode-wordpress-format","content":"<p>WordPressのPHPの記述にはコーディングルールがあります。「<a href=\"https://github.com/WordPress-Coding-Standards/WordPress-Coding-Standards\" rel=\"noopener\" target=\"_blank\">WordPress Coding Standards</a>」というものにまとめれており、「<a href=\"https://github.com/squizlabs/PHP_CodeSniffer\" rel=\"noopener\" target=\"_blank\">PHP Code Sniffer</a>」を拡張する形でチェックを行えます。</p>\n<p>このルールを意識しないでテーマ作っている人であれば、一回チェックを走らせると<strong style=\"color: #EF5350\">何百という単位でエラー箇所が見つかる</strong>はずです。そんなの、いちいち直してられませんよね&#8230;。そもそも大量にあるルールを覚えてられない&#8230;。</p>\n<p>ということで、<strong>こういう面倒な作業は自動化させるのが一番</strong>です。「WordPress Coding Standards」に準拠してフォーマットしてくれるような拡張機能をVSCodeに導入すれば「<strong class=\"marker\">保存時に自動でフォーマットしてくれる</strong>」みたいな仕組みですることができます。</p>\n<p>色々手順があるので簡単ということはでないですが、ぜひ導入して面倒な修正作業から開放されましょう！</p>\n<p>余裕がある方はこちらも↓<br />\n自動フォーマットのCSSとJavaScriptバージョンになります。<br />\n→ <a href=\"https://haniwaman.com/prettier-wordpress/\">VSCodeでPrettierを使ってWordPressのコーディング規約に沿った自動フォーマットする方法</a></p>\n<div class=\"chat\"><figure class=\"chat-img\"><img src=\"https://haniwaman.com/wp-content/themes/hpcode/img/haniwa.png\" alt=\"\"><figcaption>はにわまん</figcaption></figure><div class=\"chat-content\">適当にコーディングしても機械がちゃんと整形してくれます！</div></div>\n<div id=\"toc_container\" class=\"no_bullets\"><p class=\"toc_title\">目次</p><ul class=\"toc_list\"><li><a href=\"#VSCodephpcbf\"><span class=\"toc_number toc_depth_1\">1</span> VSCode拡張機能「phpcbf」のインストール</a></li><li><a href=\"#VSCodeWordPress_Coding_Standards\"><span class=\"toc_number toc_depth_1\">2</span> VSCodeで「WordPress Coding Standards」が使えるように</a></li><li><a href=\"#VSCodephpcbf-2\"><span class=\"toc_number toc_depth_1\">3</span> VSCode拡張機能「phpcbf」の設定を変更</a></li><li><a href=\"#PHP\"><span class=\"toc_number toc_depth_1\">4</span> 実際にPHPファイルを整形させてみよう</a></li><li><a href=\"#i\"><span class=\"toc_number toc_depth_1\">5</span> おわり</a></li></ul></div>\n<h2><span id=\"VSCodephpcbf\">VSCode拡張機能「phpcbf」のインストール</span></h2>\n<p>PHPをフォーマットするための拡張機能をVSCodeに導入します。</p>\n<p>「phpcbf」<br />\n→ <a href=\"https://marketplace.visualstudio.com/items?itemName=persoderlind.vscode-phpcbf\" rel=\"noopener\" target=\"_blank\">「phpcbf」の公式ページ</a><br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2018/08/vscode-wordpress-format-700x153.png\" alt=\"\" class=\"alignnone size-medium wp-image-8217\" width=\"520\" srcset=\"https://haniwaman.com/wp-content/uploads/2018/08/vscode-wordpress-format-700x153.png 700w, https://haniwaman.com/wp-content/uploads/2018/08/vscode-wordpress-format-768x168.png 768w, https://haniwaman.com/wp-content/uploads/2018/08/vscode-wordpress-format.png 1011w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<p>ただし、導入しただけではフォーマットしてくれません。「PHP CodeSniffer（からの WordPress Coding Standards）」のインストールとVSCodeでのいくつかの設定が必要です。</p>\n<h2><span id=\"VSCodeWordPress_Coding_Standards\">VSCodeで「WordPress Coding Standards」が使えるように</span></h2>\n<p>まずは、「WordPress Coding Standards」でのチェックがVSCode上で行えるようになっている必要があります。<br />\n（厳密にはインストールだけしてあればいいですが、チェックが動いていた方が分かりやすいということもあり&#8230;）</p>\n<p>VSCodeに「WordPress Coding Standards」を導入する方法は下記のページで紹介しています。<br />\n（「1.3 phpcs」の箇所）<br />\n→ <a href=\"https://haniwaman.com/vscode-wordpress/\">VSCodeでWordPress開発するための拡張機能とおすすめの設定</a></p>\n<p>丸投げで恐縮ですが、VSCode上でphpcsのチェックが動くようになったら、こちらのページに戻ってきてください！</p>\n<h2><span id=\"VSCodephpcbf-2\">VSCode拡張機能「phpcbf」の設定を変更</span></h2>\n<p>Windowsユーザーの場合は、3箇所変更します。<br />\n(Macユーザーは2箇所)</p>\n<p>まず1箇所目。「WordPressの規格でフォーマットする」という設定になります。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-0\">コピー</span><code id=\"code-0\" class=\"json\">\"phpcbf.standard\": \"WordPress\"\r\n</code></pre>\n<p>2箇所目。Windowsとその他のOSで指定が変わるようです（結構ハマった&#8230;）</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-1\">コピー</span><code id=\"code-1\" class=\"json\">\"phpcbf.executablePath\": \"phpcbf.bat\"\r\n</code></pre>\n<p>3箇所目。保存時にフォーマットされる、という設定に変更します。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-2\">コピー</span><code id=\"code-2\" class=\"json\">\"phpcbf.onsave\": true\r\n</code></pre>\n<p>ただ、もともとVSCodeに存在する<code>editor.formatOnSave</code>がtrueになっていると上手く動いてくれないので、falseにすること。とはいっても、、PHP以外の拡張子では<code>editor.formatOnSave</code>が動いてほしいので以下のような記述にします。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-3\">コピー</span><code id=\"code-3\" class=\"json\">\"[html]\": {\r\n\t\"editor.formatOnSave\": true,\r\n},\r\n\"[css]\": {\r\n\t\"editor.formatOnSave\": true,\r\n},\r\n\"[scss]\": {\r\n\t\"editor.formatOnSave\": true,\r\n},\r\n\"[javascript]\": {\r\n\t\"editor.formatOnSave\": true,\r\n},\r\n\"[json]\": {\r\n\t\"editor.formatOnSave\": true,\r\n},\r\n\"[php]\": {\r\n\t\"editor.formatOnSave\": false,\r\n},</code></pre>\n<p>これで準備OKです！</p>\n<h2><span id=\"PHP\">実際にPHPファイルを整形させてみよう</span></h2>\n<p>動画の方が分かりやすいので、<span class=\"filename\">functions.php</span>をフォーマットした時の様子を撮りました。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2018/08/vscode-wordpress-format.gif\" alt=\"\" class=\"alignnone size-medium wp-image-8219\" /></p>\n<p>赤字の箇所が「WordPress Coding Standards」でエラーになっていた箇所ですが、保存時に見事に消えています。</p>\n<p><span class=\"key\">Ctrl</span> + <span class=\"key\">S</span>などで保存するか、<span class=\"key\">Shift</span> + <span class=\"key\">Alt</span> + <span class=\"key\">F</span>でフォマットが発動するはずです。</p>\n<h2><span id=\"i\">おわり</span></h2><div class=\"matome\"><div class=\"matome-img\"><img src=\"https://haniwaman.com/wp-content/themes/hpcode/img/haniwa.png\" alt=\"\"></div><div class=\"matome-twitter\"><a href=\"https://twitter.com/haniwa008?ref_src=twsrc%5Etfw\" class=\"twitter-follow-button\" data-show-screen-name=\"false\" data-size=\"large\" data-lang=\"ja\" data-show-count=\"true\">Follow @haniwa008</a><script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script></div></div><!-- /matome -->\n<p>VSCodeで「WordPress Coding Standards」に準拠してPHPの自動フォーマットする方法でした。自動化できるところは、どんどん自動化していきましょう。</p>\n<p>CSSとJavaScriptの自動フォーマットについても以下でまとめていますので、こちらも合わせて導入されることをおすすめします！<br />\n→ <a href=\"https://haniwaman.com/prettier-wordpress/\">VSCodeでPrettierを使ってWordPressのコーディング規約に沿った自動フォーマットする方法</a></p>\n","date":"August 26, 2018","categories":[{"name":"環境","slug":"setting"}],"tags":[{"name":"VSCode","slug":"vscode"}],"author":{"name":"はにわまん","slug":"haniwaman"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"id":"0fdb6eb6-5329-5b3c-bbfb-46dedf6643f1"}}}