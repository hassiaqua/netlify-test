{"componentChunkName":"component---src-templates-post-js","path":"/category-color/","result":{"data":{"wordpressPost":{"id":"a75270cd-0032-59a4-bd85-01dd021d0db9","title":"カテゴリーの色を管理画面から指定してラベルの背景色とするWordPressカスタマイズ","slug":"category-color","content":"<p><strong class=\"marker\">カテゴリーの色をWordPressの管理管理画面から指定</strong>して管理できるようにしておくとお客さんでも好きに色を変えることができて便利です。</p>\n<p>「Advanced Custom Fields」を使えば簡単に設定することができるのでパターンを覚えておきましょう！</p>\n<p>当ブログのようなカテゴリーごとの色分けが簡単にできるようになります。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2019/10/category-color1-700x391.jpg\" alt=\"\" width=\"700\" class=\"alignnone size-medium wp-image-16703\" srcset=\"https://haniwaman.com/wp-content/uploads/2019/10/category-color1-700x391.jpg 700w, https://haniwaman.com/wp-content/uploads/2019/10/category-color1-1200x670.jpg 1200w, https://haniwaman.com/wp-content/uploads/2019/10/category-color1-768x429.jpg 768w, https://haniwaman.com/wp-content/uploads/2019/10/category-color1-1536x858.jpg 1536w, https://haniwaman.com/wp-content/uploads/2019/10/category-color1.jpg 1744w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<div class=\"chat\"><figure class=\"chat-img\"><img src=\"https://haniwaman.com/wp-content/themes/hpcode/img/haniwa.png\" alt=\"\"><figcaption>はにわまん</figcaption></figure><div class=\"chat-content\">実際の案件でもちょくちょく導入したりしています</div></div>\n<div id=\"toc_container\" class=\"no_bullets\"><p class=\"toc_title\">目次</p><ul class=\"toc_list\"><li><a href=\"#Advanced_Custom_Fields\"><span class=\"toc_number toc_depth_1\">1</span> 「Advanced Custom Fields」で設定していく</a><ul><li><a href=\"#Advanced_Custom_Fields-2\"><span class=\"toc_number toc_depth_2\">1.1</span> 「Advanced Custom Fields」のインストール</a></li><li><a href=\"#i\"><span class=\"toc_number toc_depth_2\">1.2</span> フィールドグループの追加</a></li></ul></li><li><a href=\"#i-2\"><span class=\"toc_number toc_depth_1\">2</span> カテゴリーでの色の設定と表示</a><ul><li><a href=\"#i-3\"><span class=\"toc_number toc_depth_2\">2.1</span> カテゴリーでの色の設定</a></li><li><a href=\"#i-4\"><span class=\"toc_number toc_depth_2\">2.2</span> 投稿からカテゴリーの指定</a></li><li><a href=\"#i-5\"><span class=\"toc_number toc_depth_2\">2.3</span> テンプレートから表示</a></li></ul></li><li><a href=\"#i-6\"><span class=\"toc_number toc_depth_1\">3</span> タクソノミーでも使用可能</a></li><li><a href=\"#i-7\"><span class=\"toc_number toc_depth_1\">4</span> おわり</a></li></ul></div>\n<h2><span id=\"Advanced_Custom_Fields\">「Advanced Custom Fields」で設定していく</span></h2>\n<p>まずは、「Advanced Custom Fields」という管理画面に編集項目を簡単に追加できるプラグインを使って、カテゴリーに色の設定項目を追加していこうと思います。</p>\n<h3><span id=\"Advanced_Custom_Fields-2\">「Advanced Custom Fields」のインストール</span></h3>\n<p>プラグイン → 新規追加 → キーワード「Advanced Custom Fields」 → 今すぐインストールから有効化までしてください！<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2019/10/category-color01-700x240.png\" alt=\"\" width=\"700\" class=\"alignnone size-medium wp-image-16380\" srcset=\"https://haniwaman.com/wp-content/uploads/2019/10/category-color01-700x240.png 700w, https://haniwaman.com/wp-content/uploads/2019/10/category-color01-768x263.png 768w, https://haniwaman.com/wp-content/uploads/2019/10/category-color01-1200x411.png 1200w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<p>ちなみに、今回はカテゴリー色に特化して紹介しますが、基本的な使い方については以下の記事で紹介しているので、使い方に不安がある方は一通り目を通してみてください。</p>\n<blockquote class=\"wp-embedded-content\" data-secret=\"YonCB0cOfr\"><p><a href=\"https://haniwaman.com/advanced-custom-fields/\">「Advanced Custom Fields」の使い方と出力方法のまとめ</a></p></blockquote>\n<p><iframe title=\"&#8220;「Advanced Custom Fields」の使い方と出力方法のまとめ&#8221; &#8212; HPcode\" class=\"wp-embedded-content\" sandbox=\"allow-scripts\" security=\"restricted\" style=\"position: absolute; clip: rect(1px, 1px, 1px, 1px);\" src=\"https://haniwaman.com/advanced-custom-fields/embed/#?secret=YonCB0cOfr\" data-secret=\"YonCB0cOfr\" width=\"500\" height=\"282\" frameborder=\"0\" marginwidth=\"0\" marginheight=\"0\" scrolling=\"no\"></iframe></p>\n<h3><span id=\"i\">フィールドグループの追加</span></h3>\n<p>「Advanced Custom Fields」をインストールすると、右側のメニューに「カスタムフィールド」の項目が追加されます。カスタムフィールド → 新規追加からカテゴリーに色をつける用のフィールドグループを追加していきます。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2019/10/category-color02.png\" alt=\"\" width=\"420\" class=\"alignnone size-full wp-image-16381\" /></p>\n<p>以下が設定例です。<strong class=\"marker\">フィールドタイプだけは確実に「カラーピッカー」にしてあげてください！</strong><br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2019/10/category-color03-700x358.png\" alt=\"\" width=\"700\" class=\"alignnone size-medium wp-image-16383\" srcset=\"https://haniwaman.com/wp-content/uploads/2019/10/category-color03-700x358.png 700w, https://haniwaman.com/wp-content/uploads/2019/10/category-color03-768x393.png 768w, https://haniwaman.com/wp-content/uploads/2019/10/category-color03-1200x614.png 1200w, https://haniwaman.com/wp-content/uploads/2019/10/category-color03.png 1828w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<table class=\"table\">\n<tr>\n<th width=\"120\">フィールドラベル</th>\n<td>色</td>\n</tr>\n<tr>\n<th>フィールド名</th>\n<td>color</td>\n</tr>\n<tr>\n<th>フィールドタイプ</th>\n<td>カラーピッカー</td>\n</tr>\n<tr>\n<th>デフォルト値</th>\n<td>#999</td>\n</tr>\n</table>\n<p>「このフィールドグループを表示する条件」では、<strong class=\"marker\">「タクソノミー」等しい「カテゴリー」</strong>としてあげます。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2019/10/category-color04-700x167.png\" alt=\"\" width=\"700\" class=\"alignnone size-medium wp-image-16384\" srcset=\"https://haniwaman.com/wp-content/uploads/2019/10/category-color04-700x167.png 700w, https://haniwaman.com/wp-content/uploads/2019/10/category-color04-768x183.png 768w, https://haniwaman.com/wp-content/uploads/2019/10/category-color04-1200x287.png 1200w, https://haniwaman.com/wp-content/uploads/2019/10/category-color04.png 1800w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<p>後はそのままで公開ボタンから保存します。</p>\n<h2><span id=\"i-2\">カテゴリーでの色の設定と表示</span></h2>\n<p>「Advanced Custom Fields」によってカテゴリーに色の設定欄が追加されるようになります。カテゴリーに色を指定しつつ、投稿から指定したカテゴリーに色をつけられるかを実際に見ていきましょう！</p>\n<h3><span id=\"i-3\">カテゴリーでの色の設定</span></h3>\n<p>まずは、投稿 → カテゴリーから色を設定していきます。今回は新規で「テスト」というカテゴリー名で青っぽい色を選択してみました。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2019/10/category-color06-700x1072.png\" alt=\"\" width=\"420\" class=\"alignnone size-medium wp-image-16387\" srcset=\"https://haniwaman.com/wp-content/uploads/2019/10/category-color06-700x1072.png 700w, https://haniwaman.com/wp-content/uploads/2019/10/category-color06-768x1176.png 768w, https://haniwaman.com/wp-content/uploads/2019/10/category-color06.png 862w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<h3><span id=\"i-4\">投稿からカテゴリーの指定</span></h3>\n<p>表示は投稿（<span class=\"filename\">single.php</span>）で確認しようと思うので、投稿の新規追加からカテゴリー「テスト」を選択した記事を1つ用意します。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2019/10/category-color07-700x232.png\" alt=\"\" width=\"700\" class=\"alignnone size-medium wp-image-16390\" srcset=\"https://haniwaman.com/wp-content/uploads/2019/10/category-color07-700x232.png 700w, https://haniwaman.com/wp-content/uploads/2019/10/category-color07-768x255.png 768w, https://haniwaman.com/wp-content/uploads/2019/10/category-color07-1200x398.png 1200w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<h3><span id=\"i-5\">テンプレートから表示</span></h3>\n<p>そして、テンプレート側から（今回の例は<span class=\"filename\">single.php</span>）から表示してみます。最小限で必要な部分だけ書き出すと、以下のような感じになります。</p>\n<pre><span class=\"filename\">single.php</span><span class=\"code-copy\" data-clipboard-target=\"#code-0\">コピー</span><code id=\"code-0\" class=\"php\">&lt;?php\r\nif ( have_posts() ) :\r\n\twhile ( have_posts() ) :\r\n\t\tthe_post();\r\n\r\n\t\t$this_categories = get_the_category();\r\n\t\tif ( $this_categories ) {\r\n\t\t\t$this_category_color = get_field( 'color', 'category_' . $this_categories[0]-&gt;term_id );\r\n\t\t\t$this_category_name  = $this_categories[0]-&gt;name;\r\n\t\t\techo '&lt;span class=\"entry-label\" style=\"' . esc_attr( 'background:' . $this_category_color ) . ';\"&gt;' . esc_html( $this_category_name ) . '&lt;/span&gt;';\r\n\t\t}\r\n\r\nendwhile;\r\nendif;</code></pre>\n<p>実行すると、カテゴリーで指定した背景色のカテゴリー名が表示されるはずです。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2019/10/category-color08.png\" alt=\"\" width=\"300\" class=\"alignnone size-full wp-image-16395\" /></p>\n<p>実はこれはちょっとだけ装飾を加えているので、ついでに共有します。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-1\">コピー</span><code id=\"code-1\" class=\"css\">.entry-label {\r\n\tdisplay: inline-block;\r\n\tborder-radius: 3px;\r\n\tpadding: 1px 6px;\r\n\tcolor: #fff;\r\n}</code></pre>\n<p>「Advanced Custom Fields」でカテゴリーの値を取得する方法は、以下のパターンになります。<br />\n<code>get_field( 'color', 'cateogory_' . $cateogory_id );</code></p>\n<p>より詳しく解説すると、</p>\n<ul class=\"check\">\n<li>第一引数は、フィールド名</li>\n<li>第二引数は、タクソノミー名 + <code>_</code>（アンダーバー） + タームID</li>\n</ul>\n<p>となっています。第二引数はあえて専門用語を使っていますが、<strong class=\"marker\">タクソノミー名は、投稿のカテゴリーの場合は「category」、投稿のタグの場合は「tag」</strong>、その他の追加したタクソノミーがある場合は、そのタクソノミー名を使います。</p>\n<p><strong class=\"marker\">タームIDは、今回でいうと投稿のカテゴリーの中で設定した「テスト」</strong>がタームに相当します。この「テスト」に割り振られたIDを指定してあげればOKです。</p>\n<p>といった感じで、細かく解説しましたが、全部関数等でループの中で取得することができないので、深く考えずにカテゴリーだけを扱うなら、今回紹介しているコードをコピペする感じでもいいかもしれません。</p>\n<p>ちなみに取得ではなく表示を行う場合は次のコードでもOKです。<br />\n<code>the_field( 'color', 'category_' . $cateogory_id );</code></p>\n<h2><span id=\"i-6\">タクソノミーでも使用可能</span></h2>\n<p>なぜ先ほど、第二引数は、「<strong>タクソノミー名 + <code>_</code>（アンダーバー） + タームID</strong>」と紹介したかというと、カテゴリーに限らず後から追加したタクソノミーで同様に作ることが可能です。</p>\n<p>タクソノミーとは、カテゴリーやタグのようなまとまり用のラベルを自作できるWordPressの仕組みで、「Custom Post Type UI」というプラグインで簡単に追加できるので、タクソノミーが分かってない人はまずは以下の記事を参考にしてみてください。</p>\n<blockquote class=\"wp-embedded-content\" data-secret=\"OpBhHMuSpS\"><p><a href=\"https://haniwaman.com/custom-post-type-ui/\">カスタム投稿タイプを簡単に作成できる「Custom Post Type UI」の使い方！</a></p></blockquote>\n<p><iframe title=\"&#8220;カスタム投稿タイプを簡単に作成できる「Custom Post Type UI」の使い方！&#8221; &#8212; HPcode\" class=\"wp-embedded-content\" sandbox=\"allow-scripts\" security=\"restricted\" style=\"position: absolute; clip: rect(1px, 1px, 1px, 1px);\" src=\"https://haniwaman.com/custom-post-type-ui/embed/#?secret=OpBhHMuSpS\" data-secret=\"OpBhHMuSpS\" width=\"500\" height=\"282\" frameborder=\"0\" marginwidth=\"0\" marginheight=\"0\" scrolling=\"no\"></iframe></p>\n<p>例えば、「shop」というタクソノミーを追加したとすると、「Advanced Custom Fields」のタクソノミーから選ぶことができるようになります。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2019/10/category-color09-700x360.png\" alt=\"\" width=\"700\" class=\"alignnone size-medium wp-image-16400\" srcset=\"https://haniwaman.com/wp-content/uploads/2019/10/category-color09-700x360.png 700w, https://haniwaman.com/wp-content/uploads/2019/10/category-color09-768x395.png 768w, https://haniwaman.com/wp-content/uploads/2019/10/category-color09-1200x617.png 1200w, https://haniwaman.com/wp-content/uploads/2019/10/category-color09.png 1832w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<p>カテゴリーのときと同様に店舗（shop）の編集画面から色を追加できるようになります。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2019/10/category-color10-700x980.png\" alt=\"\" width=\"400\" class=\"alignnone size-medium wp-image-16401\" srcset=\"https://haniwaman.com/wp-content/uploads/2019/10/category-color10-700x980.png 700w, https://haniwaman.com/wp-content/uploads/2019/10/category-color10-768x1076.png 768w, https://haniwaman.com/wp-content/uploads/2019/10/category-color10.png 854w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<p>これをテンプレートから表示するには、<code>get_the_terms()</code>からタクソノミー情報を取得するがカテゴリーと異なる点ですね。具体的には以下のようなコードです。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-2\">コピー</span><code id=\"code-2\" class=\"php\">&lt;?php\r\nif ( have_posts() ) :\r\n\twhile ( have_posts() ) :\r\n\t\tthe_post();\r\n\r\n\t\t$this_terms = get_the_terms( get_the_ID(), 'shop' );\r\n\t\tif ( $this_terms ) {\r\n\t\t\tvar_dump( $this_terms );\r\n\t\t\t$this_term_color = get_field( 'color', 'shop_' . $this_terms[0]-&gt;term_id );\r\n\t\t\t$this_term_name  = $this_terms[0]-&gt;name;\r\n\t\t\techo '&lt;span class=\"entry-label\" style=\"' . esc_attr( 'background:' . $this_term_color ) . ';\"&gt;' . esc_html( $this_term_name ) . '&lt;/span&gt;';\r\n\t\t}\r\n\r\nendwhile;\r\nendif;</code></pre>\n<p>今回は黄色に設定したので、以下のような表示になりました。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2019/10/category-color11.png\" alt=\"\" width=\"420\" class=\"alignnone size-full wp-image-16402\" /></p>\n<h2><span id=\"i-7\">おわり</span></h2><div class=\"matome\"><div class=\"matome-img\"><img src=\"https://haniwaman.com/wp-content/themes/hpcode/img/haniwa.png\" alt=\"\"></div><div class=\"matome-twitter\"><a href=\"https://twitter.com/haniwa008?ref_src=twsrc%5Etfw\" class=\"twitter-follow-button\" data-show-screen-name=\"false\" data-size=\"large\" data-lang=\"ja\" data-show-count=\"true\">Follow @haniwa008</a><script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script></div></div><!-- /matome -->\n<p>カテゴリーの色を管理画面から指定してラベルの背景色とするWordPressカスタマイズ方法でした！</p>\n<p>実際にラベルをまとめて色分けするケースは多いかと思います。WordPressで扱う場合はテンプレートにベタ打ちするよりも今回の用に管理画面から編集できるようにしてあげるとユーザーも管理しやすくなるので、ぜひ取り入れてあげてください。</p>\n","date":"November 21, 2019","categories":[{"name":"WordPress","slug":"wordpress"}],"tags":null,"author":{"name":"はにわまん","slug":"haniwaman"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"id":"a75270cd-0032-59a4-bd85-01dd021d0db9"}}}