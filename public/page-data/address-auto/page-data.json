{"componentChunkName":"component---src-templates-post-js","path":"/address-auto/","result":{"data":{"wordpressPost":{"id":"99d29745-d174-5185-83ca-9115c5090eb1","title":"WordPressのお問い合わせフォームで郵便番号から住所を自動で入力","slug":"address-auto","content":"<p>WordPressのお問い合わせフォームで郵便番号から住所を自動で入力できるようにする方法です。</p>\n<p>対象のお問い合わせフォームとして、「Contact Form 7」と「MW WP Form」で作ってみました。住所の自動入力は、フォーム入力時のユーザーのストレス軽減に繋がるので、こういうのはサクッと作れるような準備をしておきたいなって思います。</p>\n<div class=\"chat\"><figure class=\"chat-img\"><img src=\"https://haniwaman.com/wp-content/themes/hpcode/img/haniwa.png\" alt=\"\"><figcaption>はにわまん</figcaption></figure><div class=\"chat-content\">コーディングの早さを決める大半の要因は「準備」だと個人的には思っています</div></div>\n<div id=\"toc_container\" class=\"no_bullets\"><p class=\"toc_title\">目次</p><ul class=\"toc_list\"><li><a href=\"#ajaxzip3\"><span class=\"toc_number toc_depth_1\">1</span> 事前準備：「ajaxzip3」を使う</a></li><li><a href=\"#Contact_Form_7\"><span class=\"toc_number toc_depth_1\">2</span> 「Contact Form 7」で郵便番号から住所を自動入力</a><ul><li><a href=\"#Contact_Form_7-2\"><span class=\"toc_number toc_depth_2\">2.1</span> 「Contact Form 7」のタグの作り方</a></li><li><a href=\"#Contact_Form_7-3\"><span class=\"toc_number toc_depth_2\">2.2</span> 「Contact Form 7」の自動入力の処理内容</a></li></ul></li><li><a href=\"#MW_WP_Form\"><span class=\"toc_number toc_depth_1\">3</span> 「MW WP Form」で郵便番号から住所を自動入力</a><ul><li><a href=\"#MW_WP_Form-2\"><span class=\"toc_number toc_depth_2\">3.1</span> 「MW WP Form」のタグの作り方</a></li><li><a href=\"#MW_WP_Form-3\"><span class=\"toc_number toc_depth_2\">3.2</span> 「MW WP Form」の自動入力の処理内容</a></li></ul></li><li><a href=\"#ajaxzip3-2\"><span class=\"toc_number toc_depth_1\">4</span> フォーム側を「ajaxzip3」に合わせる</a></li><li><a href=\"#i\"><span class=\"toc_number toc_depth_1\">5</span> おわり</a></li></ul></div>\n<h2><span id=\"ajaxzip3\">事前準備：「ajaxzip3」を使う</span></h2>\n<p>今回は「ajaxzip3」というJavaScriptのライブラリとWordPressの「Contact Form 7」や「MW WP Form」と連動させる方法の紹介になります。</p>\n<p>以下の記事を参考に「ajaxzip3」をダウンロードしておいてください！</p>\n<blockquote class=\"wp-embedded-content\" data-secret=\"BdvxR5VQ3R\"><p><a href=\"https://haniwaman.com/ajaxzip3/\">郵便番号から住所を自動入力してくれるライブラリ「ajaxzip3」が超簡単！</a></p></blockquote>\n<p><iframe title=\"&#8220;郵便番号から住所を自動入力してくれるライブラリ「ajaxzip3」が超簡単！&#8221; &#8212; HPcode\" class=\"wp-embedded-content\" sandbox=\"allow-scripts\" security=\"restricted\" style=\"position: absolute; clip: rect(1px, 1px, 1px, 1px);\" src=\"https://haniwaman.com/ajaxzip3/embed/#?secret=BdvxR5VQ3R\" data-secret=\"BdvxR5VQ3R\" width=\"500\" height=\"282\" frameborder=\"0\" marginwidth=\"0\" marginheight=\"0\" scrolling=\"no\"></iframe></p>\n<p>ダウンロードした<span class=\"filename\">ajaxzip3.js</span>をテーマフォルダの中に入れておきます。<span class=\"folder\">js</span>フォルダの中に入れてみました。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2019/02/address-auto.png\" alt=\"\" class=\"alignnone size-full wp-image-13607\" /></p>\n<p>そして、<span class=\"filename\">functions.php</span>から<span class=\"filename\">ajaxzip3.js</span>を読み込める状態にしておきましょう。ついでに実際の処理を書くための<span class=\"filename\">script.js</span>ファイルを用意しておきます。</p>\n<pre><span class=\"filename\">functions.php</span><span class=\"code-copy\" data-clipboard-target=\"#code-0\">コピー</span><code id=\"code-0\" class=\"php\">function my_script_init() {\r\n\r\n\twp_enqueue_script( 'ajaxzip3', get_stylesheet_directory_uri() . '/js/ajaxzip3.js', array(), '0.51', true );\r\n\twp_enqueue_script( 'my', get_template_directory_uri() . '/js/script.js', array( 'jquery' ), '1.0.0', true );\r\n}\r\nadd_action( 'wp_enqueue_scripts', 'my_script_init' );</code></pre>\n<p>とりあえず準備はここまででOKです！</p>\n<h2><span id=\"Contact_Form_7\">「Contact Form 7」で郵便番号から住所を自動入力</span></h2>\n<p>それでは、「Contact Form 7」で作成したフォームで、「郵便番号から住所を自動入力」を実現したいと思います。</p>\n<h3><span id=\"Contact_Form_7-2\">「Contact Form 7」のタグの作り方</span></h3>\n<p>「コンタクトフォームの編集」の「フォーム」タブに入力する内容として、必要な部分だけを抜粋すると以下のようになります。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-1\">コピー</span><code id=\"code-1\" class=\"html\">&lt;dl&gt;\r\n&lt;dt&gt;郵便番号&lt;/dt&gt;\r\n&lt;dd&gt;[text your-zip id:your-zip]&lt;/dd&gt;\r\n\r\n&lt;dt&gt;都道府県&lt;/dt&gt;\r\n&lt;dd&gt;[select your-prefecture include_blank \"北海道\" \"青森県\" \"岩手県\" \"宮城県\" \"秋田県\" \"山形県\" \"福島県\" \"茨城県\" \"栃木県\" \"群馬県\" \"埼玉県\" \"千葉県\" \"東京都\" \"神奈川県\" \"新潟県\" \"富山県\" \"石川県\" \"福井県\" \"山梨県\" \"長野県\" \"岐阜県\" \"静岡県\" \"愛知県\" \"三重県\" \"滋賀県\" \"京都府\" \"大阪府\" \"兵庫県\" \"奈良県\" \"和歌山県\" \"鳥取県\" \"島根県\" \"岡山県\" \"広島県\" \"山口県\" \"徳島県\" \"香川県\" \"愛媛県\" \"高知県\" \"福岡県\" \"佐賀県\" \"長崎県\" \"熊本県\" \"大分県\" \"宮崎県\" \"鹿児島県\" \"沖縄県\"]&lt;/dd&gt;\r\n\r\n&lt;dt&gt;以降の住所&lt;/dt&gt;\r\n&lt;dd&gt;[text your-address]&lt;/dd&gt;\r\n&lt;/dl&gt;</code></pre>\n<h3><span id=\"Contact_Form_7-3\">「Contact Form 7」の自動入力の処理内容</span></h3>\n<p>大事なのは郵便番号にidを指定することです。このidを利用して、自動入力の処理を<span class=\"filename\">script.js</span>に書いていきます。</p>\n<p><code>keyup</code>のイベントを使うことで郵便番号に入力されるたびに処理を動かせるようになっています。</p>\n<pre><span class=\"filename\">script.js</span><span class=\"code-copy\" data-clipboard-target=\"#code-2\">コピー</span><code id=\"code-2\" class=\"js\">jQuery( '#your-zip' ).keyup( function() {\r\n\tAjaxZip3.zip2addr( this, '', 'your-prefecture', 'your-address' );\r\n});</code></pre>\n<p>実際に動きを確認すると、ちゃんと機能していることが確認できます！（ハイフンあってもなくてもOK）<br />\n<img width=\"520\" src=\"https://haniwaman.com/wp-content/uploads/2019/02/address-auto-700x400.gif\" alt=\"\" class=\"alignnone size-medium wp-image-13608\" /></p>\n<p>めっちゃどうでもいいですが、上記の住所は三重が誇るテーマパーク「<a href=\"http://www.nagashima-onsen.co.jp/spaland/index.html/\" rel=\"noopener\" target=\"_blank\">長島スパーランド</a>」です。</p>\n<h2><span id=\"MW_WP_Form\">「MW WP Form」で郵便番号から住所を自動入力</span></h2>\n<p>続いては「MW WP Form」で作成したフォームで、「郵便番号から住所を自動入力」を実現したいと思います。</p>\n<h3><span id=\"MW_WP_Form-2\">「MW WP Form」のタグの作り方</span></h3>\n<p>「フォームを編集」で入力する内容で必要な部分だけを抜粋すると以下のようになります。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-3\">コピー</span><code id=\"code-3\" class=\"html\">&lt;dl&gt;\r\n&lt;dt&gt;郵便番号&lt;/dt&gt;\r\n&lt;dd&gt;[mwform_text name=\"your-zip\" id=\"your-zip\"]&lt;/dd&gt;\r\n\r\n&lt;dt&gt;都道府県&lt;/dt&gt;\r\n&lt;dd&gt;[mwform_select name=\"your-prefecture\" children=\"北海道,青森県,岩手県,宮城県,秋田県,山形県,福島県,茨城県,栃木県,群馬県,埼玉県,千葉県,東京都,神奈川県,新潟県,富山県,石川県,福井県,山梨県,長野県,岐阜県,静岡県,愛知県,三重県,滋賀県,京都府,大阪府,兵庫県,奈良県,和歌山県,鳥取県,島根県,岡山県,広島県,山口県,徳島県,香川県,愛媛県,高知県,福岡県,佐賀県,長崎県,熊本県,大分県,宮崎県,鹿児島県,沖縄県\"]&lt;/dd&gt;\r\n\r\n&lt;dt&gt;以降の住所&lt;/dt&gt;\r\n&lt;dd&gt;[mwform_text name=\"your-address\"]&lt;/dd&gt;\r\n\r\n&lt;/dl&gt;</code></pre>\n<h3><span id=\"MW_WP_Form-3\">「MW WP Form」の自動入力の処理内容</span></h3>\n<p>こちらも大事なのは郵便番号にidを指定することです。このidを利用して、自動入力の処理を<span class=\"filename\">script.js</span>に書いていきます。</p>\n<pre><span class=\"filename\">script.js</span><span class=\"code-copy\" data-clipboard-target=\"#code-2\">コピー</span><code id=\"code-2\" class=\"js\">jQuery( '#your-zip' ).keyup( function() {\r\n\tAjaxZip3.zip2addr( this, '', 'your-prefecture', 'your-address' );\r\n});</code></pre>\n<p>実際の動きになります。（ハイフンあってもなくてもOK）<br />\n<img width=\"520\" src=\"https://haniwaman.com/wp-content/uploads/2019/02/address-auto2-700x400.gif\" alt=\"\" class=\"alignnone size-medium wp-image-13609\" /></p>\n<h2><span id=\"ajaxzip3-2\">フォーム側を「ajaxzip3」に合わせる</span></h2>\n<p>「Contact Form 7」を使うにしても「MW WP Form」を使うにしても考え方は同じで、JavaScriptのライブラリである<strong class=\"marker\">「ajaxzip3」に型を合わせるだけ</strong>です。</p>\n<p>今回のように都道府県をドロップダウンで作って以降の住所を別のテキストエリアにする以外にも、都道府県と市区町村と以降の住所を3分割させたり、都道府県から住所を1つのテキストエリアにまとめたり、と色んな表現をすることが可能です。</p>\n<p>手前味噌で恐縮ですが、いくつかのパターンは以下の記事で紹介しています。</p>\n<blockquote class=\"wp-embedded-content\" data-secret=\"BdvxR5VQ3R\"><p><a href=\"https://haniwaman.com/ajaxzip3/\">郵便番号から住所を自動入力してくれるライブラリ「ajaxzip3」が超簡単！</a></p></blockquote>\n<p><iframe title=\"&#8220;郵便番号から住所を自動入力してくれるライブラリ「ajaxzip3」が超簡単！&#8221; &#8212; HPcode\" class=\"wp-embedded-content\" sandbox=\"allow-scripts\" security=\"restricted\" style=\"position: absolute; clip: rect(1px, 1px, 1px, 1px);\" src=\"https://haniwaman.com/ajaxzip3/embed/#?secret=BdvxR5VQ3R\" data-secret=\"BdvxR5VQ3R\" width=\"500\" height=\"282\" frameborder=\"0\" marginwidth=\"0\" marginheight=\"0\" scrolling=\"no\"></iframe></p>\n<p>クライアントの要望に応じて、柔軟にフォームの形は変更できるというイメージを持ってもらえたらと思います！</p>\n<h2><span id=\"i\">おわり</span></h2><div class=\"matome\"><div class=\"matome-img\"><img src=\"https://haniwaman.com/wp-content/themes/hpcode/img/haniwa.png\" alt=\"\"></div><div class=\"matome-twitter\"><a href=\"https://twitter.com/haniwa008?ref_src=twsrc%5Etfw\" class=\"twitter-follow-button\" data-show-screen-name=\"false\" data-size=\"large\" data-lang=\"ja\" data-show-count=\"true\">Follow @haniwa008</a><script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script></div></div><!-- /matome -->\n<p>WordPressのお問い合わせフォームで郵便番号から住所を自動で入力させる方法でした。WordPressと言いつつ、基本的には「ajaxzip3」の扱い方を知っていることの方が大事な気もします。</p>\n<p>「ajaxzip3」で実現できることに対して、「Contact Form 7」や「MW WP Form」のテンプレートタグで使ってHTMLのフォームを作っていくようなイメージですね。</p>\n<p>とは言え、今回紹介した記事はコピペで使えるはずなので、とりあえず動きを確認したい方はぜひ使ってみてください！</p>\n","date":"February 12, 2019","categories":[{"name":"WordPress","slug":"wordpress"}],"tags":null,"author":{"name":"はにわまん","slug":"haniwaman"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"id":"99d29745-d174-5185-83ca-9115c5090eb1"}}}