{"componentChunkName":"component---src-templates-post-js","path":"/contact-form-7-add-page/","result":{"data":{"wordpressPost":{"id":"784295e3-d791-5c74-b2cc-854fc4522e35","title":"Contact Form 7で確認画面と完了画面（サンクスページ）を追加する方法","slug":"contact-form-7-add-page","content":"<p>Contact Form 7で確認画面と完了画面を追加する方法について紹介します！<br />\nただし、確認画面については一般的なイメージとは異なりページの遷移はしません。</p>\n<p>※ ページ遷移するお問い合わせフォームがほしい場合は、「MW WP Form」をお試しください。<br />\n参考 → <a href=\"https://haniwaman.com/mw-wp-form/\">確認画面、完了画面を作りたいなら「MW WP Form」1択！使い方と設定方法</a></p>\n<div class=\"chat\"><figure class=\"chat-img\"><img src=\"https://haniwaman.com/wp-content/themes/hpcode/img/haniwa.png\" alt=\"\"><figcaption>はにわまん</figcaption></figure><div class=\"chat-content\">Contact Form 7で確認画面を追加するにはプラグインを使用します</div></div>\n<div id=\"toc_container\" class=\"no_bullets\"><p class=\"toc_title\">目次</p><ul class=\"toc_list\"><li><a href=\"#i\"><span class=\"toc_number toc_depth_1\">1</span> 確認画面を追加する方法</a><ul><li><a href=\"#Contact_Form_7_add_confirm\"><span class=\"toc_number toc_depth_2\">1.1</span> Contact Form 7 add confirmのインストールと設定</a></li><li><a href=\"#i-2\"><span class=\"toc_number toc_depth_2\">1.2</span> 確認画面の動作確認</a></li></ul></li><li><a href=\"#i-3\"><span class=\"toc_number toc_depth_1\">2</span> 完了画面を追加する方法</a><ul><li><a href=\"#i-4\"><span class=\"toc_number toc_depth_2\">2.1</span> 完了ページの準備</a></li><li><a href=\"#i-5\"><span class=\"toc_number toc_depth_2\">2.2</span> ページ遷移の設定</a></li><li><a href=\"#i-6\"><span class=\"toc_number toc_depth_2\">2.3</span> ページ遷移の動作確認</a></li><li><a href=\"#i-7\"><span class=\"toc_number toc_depth_2\">2.4</span> お問い合わせ毎にサンクスページを振り分けたい</a></li></ul></li><li><a href=\"#i-8\"><span class=\"toc_number toc_depth_1\">3</span> おわり</a></li></ul></div>\n<h2><span id=\"i\">確認画面を追加する方法</span></h2>\n<p>確認画面は、「Contact Form 7 add confirm」というプラグインを使います。<br />\n公式：<a href=\"https://ja.wordpress.org/plugins/contact-form-7-add-confirm/\" rel=\"noopener\" target=\"_blank\">https://ja.wordpress.org/plugins/contact-form-7-add-confirm/</a></p>\n<p>Contact Form 7においては、このプラグインを使う方法が最も簡単な方法です。</p>\n<h3><span id=\"Contact_Form_7_add_confirm\">Contact Form 7 add confirmのインストールと設定</span></h3>\n<p>プラグインをインストールして有効化してください。</p>\n<p>プラグイン → 新規追加 → キーワード「Contact Form 7 add confirm」 → 今すぐインストール → 有効化<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2018/02/contact-form-7-add-page-700x365.png\" alt=\"\" width=\"700\" height=\"365\" class=\"alignnone size-medium wp-image-4161\" srcset=\"https://haniwaman.com/wp-content/uploads/2018/02/contact-form-7-add-page-700x365.png 700w, https://haniwaman.com/wp-content/uploads/2018/02/contact-form-7-add-page-768x400.png 768w, https://haniwaman.com/wp-content/uploads/2018/02/contact-form-7-add-page.png 931w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<p>プラグインを導入できたら「Contact Form 7」の設定画面を見てみてください。<strong class=\"marker\">「確認ボタン」「戻って編集ボタン」の2つボタンが追加されている</strong>ことが分かります。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2018/02/contact-form-7-add-page2-700x329.png\" alt=\"\" width=\"700\" height=\"329\" class=\"alignnone size-medium wp-image-4163\" srcset=\"https://haniwaman.com/wp-content/uploads/2018/02/contact-form-7-add-page2-700x329.png 700w, https://haniwaman.com/wp-content/uploads/2018/02/contact-form-7-add-page2-768x360.png 768w, https://haniwaman.com/wp-content/uploads/2018/02/contact-form-7-add-page2.png 831w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<p>フライング気味で画像に書かれてしまっていますが、こちらの２つのボタンをクリックして追加してあげてください。</p>\n<p>記載する順番は、以下のとおりでお願いします。</p>\n<ol>\n<li><code>&#091;confirm \"確認\"&#093;</code></li>\n<li><code>&#091;back \"戻る\"&#093;</code></li>\n<li><code>&#091;submit \"送信\"&#093;</code></li>\n</ol>\n<p><img src=\"https://haniwaman.com/wp-content/uploads/2018/02/contact-form-7-add-page3-700x265.png\" alt=\"\" width=\"700\" height=\"265\" class=\"alignnone size-medium wp-image-4168\" srcset=\"https://haniwaman.com/wp-content/uploads/2018/02/contact-form-7-add-page3-700x265.png 700w, https://haniwaman.com/wp-content/uploads/2018/02/contact-form-7-add-page3-768x291.png 768w, https://haniwaman.com/wp-content/uploads/2018/02/contact-form-7-add-page3.png 789w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<p>設定はたったこれだけです！<br />\n実際の動作を確認してみましょう。</p>\n<h3><span id=\"i-2\">確認画面の動作確認</span></h3>\n<p>お問い合わせ画面を開くと、いつもは送信ボタンだった場所が「確認ボタン」になっていることが分かります。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2018/02/contact-form-7-add-page4.png\" alt=\"\" width=\"519\" height=\"541\" class=\"alignnone size-full wp-image-4170\" /></p>\n<p>項目を入力し、エラーがなければ確認画面を表示します（ページの遷移ではありません。）<br />\nボタンの種類も「送信ボタン」か「戻るボタン」に変わっていることが分かります。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2018/02/contact-form-7-add-page5.png\" alt=\"\" width=\"502\" height=\"542\" class=\"alignnone size-full wp-image-4171\" /></p>\n<p>「送信ボタン」を押せば送信されますし、「戻るボタン」を押せばまた入力できるようになるといった動きです。</p>\n<h2><span id=\"i-3\">完了画面を追加する方法</span></h2>\n<p>完了画面を追加する機能については、「Contact Form 7」が標準で用意してくれています。ただしカスタマイズが必要ですが&#8230;。</p>\n<h3><span id=\"i-4\">完了ページの準備</span></h3>\n<p>確認画面と違って、完了画面はページ遷移します。なので、事前にページを準備しておかなければなりません。</p>\n<p>固定ページにテスト用で作りました。内容は自由です。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2018/02/contact-form-7-add-page6-700x560.png\" alt=\"\" width=\"700\" height=\"560\" class=\"alignnone size-medium wp-image-4174\" srcset=\"https://haniwaman.com/wp-content/uploads/2018/02/contact-form-7-add-page6-700x560.png 700w, https://haniwaman.com/wp-content/uploads/2018/02/contact-form-7-add-page6-768x614.png 768w, https://haniwaman.com/wp-content/uploads/2018/02/contact-form-7-add-page6.png 858w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<h3><span id=\"i-5\">ページ遷移の設定</span></h3>\n<p>ページを遷移させるための記述は<span class=\"file\">functions.php</span>に記載していきます。</p>\n<pre><span class=\"file\">functions.php</span><span class=\"code-copy\" data-clipboard-target=\"#code-0\">コピー</span><code id=\"code-0\" class=\"php\">add_action( 'wp_footer', 'add_thanks_page' );\r\nfunction add_thanks_page() {\r\necho &lt;&lt;&lt; EOD\r\n&lt;script&gt;\r\ndocument.addEventListener( 'wpcf7mailsent', function( event ) {\r\n\tlocation = 'https://haniwaman.com/thanks/'; /* 遷移先のURL */\r\n}, false );\r\n&lt;/script&gt;\r\nEOD;\r\n}</code></pre>\n<p><code>location = '';</code>の値は、先程作成したサンクスページのURLを指定しください。ここで指定したURLに送信後に遷移される仕組みとなっています。</p>\n<p>公式：<a href=\"https://contactform7.com/ja/redirecting-to-another-url-after-submissions/\" rel=\"noopener\" target=\"_blank\">https://contactform7.com/ja/redirecting-to-another-url-after-submissions/</a></p>\n<h3><span id=\"i-6\">ページ遷移の動作確認</span></h3>\n<p>お問い合わせ画面から送信ボタンを押してみてください。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2018/02/contact-form-7-add-page7.png\" alt=\"\" width=\"545\" height=\"551\" class=\"alignnone size-full wp-image-4177\" /></p>\n<p>設定した、URLに遷移していることが分かります。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2018/02/contact-form-7-add-page8.png\" alt=\"\" width=\"395\" height=\"177\" class=\"alignnone size-full wp-image-4178\" /></p>\n<h3><span id=\"i-7\">お問い合わせ毎にサンクスページを振り分けたい</span></h3>\n<p>今の設定だと、すべてのお問合わせのサンクスページが同じものとなってしまいます。振り分けたい場合もあるかと思いますので、その方法を紹介します。</p>\n<h4>お問い合わせページのIDを調べる</h4>\n<p>もっとも確実なのは、お問合わせのページIDで振り分ける方法です。WordPressでは表には出てないですが、記事ごとにIDを持っています。</p>\n<p>確認方法は少し手間ですが、固定ページ一覧からタイトルにマウス重ねて、URLが表示されるので、その中にある<strong class=\"marker\">post=〇〇の数字</strong>がその記事のIDとなります。<br />\n※ サンクスページではなく、お問い合わせページのIDを確認してください。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2018/02/contact-form-7-add-page9.png\" alt=\"\" width=\"470\" height=\"261\" class=\"alignnone size-full wp-image-4185\" /></p>\n<p>この例では、「4156」がページIDだと分かります。</p>\n<h4>IDで振り分ける処理を追記</h4>\n<p>functions.phpに記載した処理に2行だけ加えて「4156」がページIDの時だけ遷移するという処理にしてみます。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-1\">コピー</span><code id=\"code-1\" class=\"php\">add_action( 'wp_footer', 'add_thanks_page' );\r\nfunction add_thanks_page() {\r\nif( get_the_ID() == '4156' ) {\r\necho &lt;&lt;&lt; EOD\r\n&lt;script&gt;\r\ndocument.addEventListener( 'wpcf7mailsent', function( event ) {\r\n\tlocation = 'https://haniwaman.com/thanks/'; /* 遷移先のURL */\r\n}, false );\r\n&lt;/script&gt;\r\nEOD;\r\n}\r\n}</code></pre>\n<p><code>echo</code>で出力させている部分を<code>if( get_the_ID() == '4156' ) {}</code>で囲っているだけです。他のページも追加する際は、ifの中身からごっそりコピーしてID部分とlocation部分を変えるだけになります。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-2\">コピー</span><code id=\"code-2\" class=\"php\">add_action( 'wp_footer', 'add_thanks_page' );\r\nfunction add_thanks_page() {\r\nif( get_the_ID() == '4156' ) {\r\necho &lt;&lt;&lt; EOD\r\n&lt;script&gt;\r\ndocument.addEventListener( 'wpcf7mailsent', function( event ) {\r\n\tlocation = 'https://haniwaman.com/thanks/'; /* 遷移先のURL */\r\n}, false );\r\n&lt;/script&gt;\r\nEOD;\r\n}\r\nif( get_the_ID() == '○○○' ) { /* ページID */\r\necho &lt;&lt;&lt; EOD\r\n&lt;script&gt;\r\ndocument.addEventListener( 'wpcf7mailsent', function( event ) {\r\n\tlocation = '○○○'; /* 遷移先のURL */\r\n}, false );\r\n&lt;/script&gt;\r\nEOD;\r\n}\r\n}</code></pre>\n<h2><span id=\"i-8\">おわり</span></h2><div class=\"matome\"><div class=\"matome-img\"><img src=\"https://haniwaman.com/wp-content/themes/hpcode/img/haniwa.png\" alt=\"\"></div><div class=\"matome-twitter\"><a href=\"https://twitter.com/haniwa008?ref_src=twsrc%5Etfw\" class=\"twitter-follow-button\" data-show-screen-name=\"false\" data-size=\"large\" data-lang=\"ja\" data-show-count=\"true\">Follow @haniwa008</a><script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script></div></div><!-- /matome -->\n<p>Contact Form 7で確認画面と完了画面（サンクスページ）を追加する方法でした。</p>\n<p>今は不要と言われがちな確認画面と完了画面ですが、まだまだ利用シーン（需要）はあるように思えます。WordPressで最も使われている「Contact Form 7」でも使えるようになっておくとカスタマイズの幅が広がるのではないでしょうか。</p>\n","date":"February 16, 2018","categories":[{"name":"WordPress","slug":"wordpress"}],"tags":[{"name":"WordPressプラグイン","slug":"plugin"}],"author":{"name":"はにわまん","slug":"haniwaman"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"id":"784295e3-d791-5c74-b2cc-854fc4522e35"}}}