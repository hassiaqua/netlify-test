{"componentChunkName":"component---src-templates-post-js","path":"/highlight-js/","result":{"data":{"wordpressPost":{"id":"42216f73-cc6e-5216-bddd-debe0ea2a165","title":"jQuery不要の軽量コードハイライト！「highlight.js」の解説","slug":"highlight-js","content":"<p>jQuery不要、軽量で使いやすいコードハイライト！「highlight.js」を紹介します。</p>\n<p>この記事内でも、いたるとこでhighlight.jsが動いています。</p>\n<div class=\"chat\"><figure class=\"chat-img\"><img src=\"https://haniwaman.com/wp-content/themes/hpcode/img/haniwa.png\" alt=\"\"><figcaption>はにわまん</figcaption></figure><div class=\"chat-content\">コードをたくさん貼り付けるわたしにとって、ありがたいライブラリです</div></div>\n<div id=\"toc_container\" class=\"no_bullets\"><p class=\"toc_title\">目次</p><ul class=\"toc_list\"><li><a href=\"#i\"><span class=\"toc_number toc_depth_1\">1</span> ダウンロード</a></li><li><a href=\"#i-2\"><span class=\"toc_number toc_depth_1\">2</span> 使い方</a><ul><li><a href=\"#i-3\"><span class=\"toc_number toc_depth_2\">2.1</span> ライブラリを読み込む</a></li><li><a href=\"#i-4\"><span class=\"toc_number toc_depth_2\">2.2</span> 表示させるアイテム</a></li><li><a href=\"#highlightjs\"><span class=\"toc_number toc_depth_2\">2.3</span> 「highlight.js」の設定（初期化）</a></li><li><a href=\"#highlightjs-2\"><span class=\"toc_number toc_depth_2\">2.4</span> 「highlight.js」の設定（オプション）</a></li><li><a href=\"#i-5\"><span class=\"toc_number toc_depth_2\">2.5</span> 右上に言語を出すカスタマイズ</a></li></ul></li><li><a href=\"#i-6\"><span class=\"toc_number toc_depth_1\">3</span> おわり</a></li></ul></div>\n<h2><span id=\"i\">ダウンロード</span></h2>\n<p>※ ver 9.12.0時点の内容です。</p>\n<p>公式サイトへアクセスします。<br />\n→ <a href=\"https://highlightjs.org/\" rel=\"noopener\" target=\"_blank\">https://highlightjs.org/</a></p>\n<p>右下にある「Get version xx.xx.xx」をクリック。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2018/01/highlight-js-700x436.png\" alt=\"\" width=\"700\" height=\"436\" class=\"alignnone size-medium wp-image-3450\" srcset=\"https://haniwaman.com/wp-content/uploads/2018/01/highlight-js-700x436.png 700w, https://haniwaman.com/wp-content/uploads/2018/01/highlight-js-768x479.png 768w, https://haniwaman.com/wp-content/uploads/2018/01/highlight-js.png 857w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<p>中段にある「Custom package」内で必要な言語を選びます。（わからなければデフォルトのままでもOK）<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2018/01/clipboard-js2-700x276.png\" alt=\"\" width=\"700\" height=\"276\" class=\"alignnone size-medium wp-image-3451\" srcset=\"https://haniwaman.com/wp-content/uploads/2018/01/clipboard-js2-700x276.png 700w, https://haniwaman.com/wp-content/uploads/2018/01/clipboard-js2.png 767w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<p>小さくてわかりづらいですが、さらにスクロールした先にある「Download」ボタンからダウンロードしてください。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2018/01/highlight-js3-700x320.png\" alt=\"\" width=\"700\" height=\"320\" class=\"alignnone size-medium wp-image-3452\" srcset=\"https://haniwaman.com/wp-content/uploads/2018/01/highlight-js3-700x320.png 700w, https://haniwaman.com/wp-content/uploads/2018/01/highlight-js3-768x351.png 768w, https://haniwaman.com/wp-content/uploads/2018/01/highlight-js3.png 788w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<p>必要なファイルは、</p>\n<ul>\n<li>highlight.pack.js</li>\n<li>styles/hogehoge.css ※ 好きなファイルを1つ選ぶ</li>\n</ul>\n<p>の2つです。</p>\n<h2><span id=\"i-2\">使い方</span></h2>\n<h3><span id=\"i-3\">ライブラリを読み込む</span></h3>\n<p>わたしが普段使っているスタイルは、<span class=\"file\">tomorrow-night-eighties.css</span>です。他にもたくさんあるので、いろいろと試してみてください。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-0\">コピー</span><code id=\"code-0\" class=\"html\">&lt;link rel=\"stylesheet\" href=\"styles/tomorrow-night-eighties.css\"&gt;\r\n&lt;script src=\"highlight.pack.js\"&gt;&lt;/script&gt;\r\n</code></pre>\n<h3><span id=\"i-4\">表示させるアイテム</span></h3>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-1\">コピー</span><code id=\"code-1\" class=\"html\">&lt;pre&gt;&lt;code&gt;ここにコードを記載\r\n&lt;/code&gt;&lt;/pre&gt;</code></pre>\n<p>実際にはこんな感じ。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-2\">コピー</span><code id=\"code-2\" class=\"html\">&lt;pre&gt;&lt;code&gt;body {\r\n\tbackground: #fff;\r\n\tfont-size: 1em;\r\n}\r\n&lt;/code&gt;&lt;/pre&gt;\r\n</code></pre>\n<h3><span id=\"highlightjs\">「highlight.js」の設定（初期化）</span></h3>\n<p>以下の一文を入れるだけで<code>&lt;pre&gt;&lt;code&gt;</code>で囲んだエリアをハイライトに処理してくれます。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-3\">コピー</span><code id=\"code-3\" class=\"js\">hljs.initHighlightingOnLoad();\r\n</code></pre>\n<h3><span id=\"highlightjs-2\">「highlight.js」の設定（オプション）</span></h3>\n<h4>任意の要素をハイライトする</h4>\n<p>デフォルトでは、<code>&lt;pre&gt;&lt;code&gt;</code>がハイライトされるようになっています。</p>\n<p>サイトの設計によっては違うタグをハイライトしたいかもしれません。「highlight.js」では任意のタグにハイライトすることも可能です。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-4\">コピー</span><code id=\"code-4\" class=\"js\">$('div.code').each(function(i, block) {\r\n  hljs.highlightBlock(block);\r\n});</code></pre>\n<p>公式ドキュメント → <a href=\"https://highlightjs.org/usage/\" rel=\"noopener\" target=\"_blank\">https://highlightjs.org/usage/</a></p>\n<p>これで、<code>&lt;div class=\"code\"&gt;&lt;/div&gt;</code>で囲まれた要素がハイライトされるようになります。</p>\n<h4>タブの文字数を調整する</h4>\n<p><code>hljs.configure</code>でタブのスペースの文字数を調整できます。デフォルトでは4文字ですが、少し広いので2文字に変更しましょう。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-5\">コピー</span><code id=\"code-5\" class=\"js\">hljs.configure({\r\n\ttabReplace: '  ' // 2文字分のスペースを入力\r\n});</code></pre>\n<p>公式ドキュメント → <a href=\"http://highlightjs.readthedocs.io/en/latest/api.html#configure-options\" rel=\"noopener\" target=\"_blank\">http://highlightjs.readthedocs.io/en/latest/api.html#configure-options</a></p>\n<div class=\"box\">\n<h5>WordPressが勝手にタブを消す問題</h5>\n<p>\tWordPressを使っていて少しハマりました。</p>\n<p>\t<code>tabReplace: '  '</code>を設定しても、全く変わる気配がありません。これは、WordPressが投稿の保存時にタブをスペースに自動変換しているからです。つまりhighlight.jsがタブを変換しようとしたときにはタブは存在しないということですね。</p>\n<p>\tWordPressは、タブ（<code>\\t</code>）を、スペース4つとして変換します。回り道になりますが、スペース4つを<code>\\t</code>に戻し、highlight.jsに再度スペースに戻してもらうという手順を踏みました。</p>\n<p>\t具体的には、<span class=\"file\">functions.php</span>に、以下のコードを追記します。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-6\">コピー</span><code id=\"code-6\" class=\"php\">function do_not_convert_from_tab_to_space( $text ) {\r\n\t$text = str_replace( \"半角スペースを4つ分、記載する\", \"\\t\", $text );\r\n\treturn $text;\r\n}\r\nadd_filter( \"wpcom_markdown_transform_post\", \"do_not_convert_from_tab_to_space\" );\r\n</code></pre>\n<p>※ 参考：<a href=\"https://wiredpunch.com/wordpress%E3%81%AE%E8%A8%98%E4%BA%8B%E5%86%85%E3%81%AB%E3%81%82%E3%82%8B%E3%82%BF%E3%83%96%E3%81%8C%E3%80%81%E5%8B%9D%E6%89%8B%E3%81%AB%E3%82%B9%E3%83%9A%E3%83%BC%E3%82%B94%E3%81%A4%E3%81%AB%E5%A4%89/\" rel=\"noopener\" target=\"_blank\">WordPressの記事内にあるタブが、勝手にスペース4つに変換される処理を無効化する方法。</a></p>\n<p>記載したあとに<strong class=\"marker\">記事を保存しなおす</strong>と、スペースをタブに戻して表示してくれるようになります。</p>\n</div>\n<h4>言語を指定できる</h4>\n<p>highlight.jsは自動で言語を認識してくれますが、こちら側から言語を指定してハイライトしてもらうことも可能です。</p>\n<p>指定方法は簡単で、<code>&lt;code&gt;</code>にクラスを指定するだけです。</p>\n<p>HTMLなら以下のような感じ。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-7\">コピー</span><code id=\"code-7\" class=\"html\">&lt;pre&gt;&lt;code class=\"html\"&gt;&lt;/code&gt;&lt;/pre&gt;\r\n</code></pre>\n<p>よく使う言語と対応しているクラスは以下のとおりです。</p>\n<table class=\"table\">\n<tr>\n<th width=\"138\">HTML</th>\n<td>html</td>\n</tr>\n<tr>\n<th>CSS</th>\n<td>css</td>\n</tr>\n<tr>\n<th>JavaScript</th>\n<td>js</td>\n</tr>\n<tr>\n<th>PHP</th>\n<td>php</td>\n</tr>\n</table>\n<p>その他の言語は、公式ドキュメントをご参照ください。<br />\n公式ドキュメント → <a href=\"http://highlightjs.readthedocs.io/en/latest/css-classes-reference.html#language-names-and-aliases\" rel=\"noopener\" target=\"_blank\">http://highlightjs.readthedocs.io/en/latest/css-classes-reference.html#language-names-and-aliases</a></p>\n<h4>highlight.jsの注意点</h4>\n<p>最後の<code>&lt;/code&gt;&lt;/pre&gt;</code>を改行しないと、<strong class=\"marker\">言語を正しく認識してくれません</strong>。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-8\">コピー</span><code id=\"code-8\" class=\"html\">&lt;pre&gt;&lt;code&gt;hogehoge&lt;/code&gt;&lt;/pre&gt;\r\n</code></pre>\n<p>ではなく、</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-9\">コピー</span><code id=\"code-9\" class=\"html\">&lt;pre&gt;&lt;code&gt;hogehoge\r\n&lt;/code&gt;&lt;/pre&gt;</code></pre>\n<p>と指定するようにしましょう。</p>\n<h3><span id=\"i-5\">右上に言語を出すカスタマイズ</span></h3>\n<p>ソースコードごとの言語を出すと、見やすくなります。highlight.jsの標準機能にはありませんが、言語に応じて右上に言語の種類を表示してあげるカスタマイズをしてみます。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-10\">コピー</span><code id=\"code-10\" class=\"css\">.hljs {\r\n\tposition: relative;\r\n\tpadding: 40px 12px 12px;\r\n}\r\n.hljs::before {\r\n\tposition: absolute;\r\n\ttop: 0;\r\n\tleft: 0;\r\n\tcontent: '';\r\n\tcolor: #fff;\r\n\tfont-weight: bold;\r\n\tpadding: 2px 8px;\r\n}\r\n.hljs.html.xml::before {\r\n\tcontent: 'HTML';\r\n\tbackground-color: #e44d26;\r\n}\r\n.hljs.css::before {\r\n\tcontent: 'CSS';\r\n\tbackground-color: #006eb9;\r\n}\r\n.hljs.js::before {\r\n\tcontent: 'JavaScript';\r\n\tbackground-color: #e5a228;\r\n}\r\n.hljs.php::before {\r\n\tcontent: 'PHP';\r\n\tbackground-color: #8892bf;\r\n}</code></pre>\n<p><code>.hljs</code>は、ハイライト対象となる要素に自動で付与されるクラスです。この<code>.hljs</code>と、言語ごとに付与されるクラスを利用して、言語ごとに違いを出しています。</p>\n<h2><span id=\"i-6\">おわり</span></h2><div class=\"matome\"><div class=\"matome-img\"><img src=\"https://haniwaman.com/wp-content/themes/hpcode/img/haniwa.png\" alt=\"\"></div><div class=\"matome-twitter\"><a href=\"https://twitter.com/haniwa008?ref_src=twsrc%5Etfw\" class=\"twitter-follow-button\" data-show-screen-name=\"false\" data-size=\"large\" data-lang=\"ja\" data-show-count=\"true\">Follow @haniwa008</a><script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script></div></div><!-- /matome -->\n<p>jQuery不要の軽量コードハイライト！「highlight.js」の紹介でした。</p>\n<p>わたしもとても重宝しています。デザインも豊富でカスタマイズもしやすいので、コードをたくさん書く人はぜひ導入してみてください！</p>\n","date":"January 14, 2018","categories":[{"name":"JavaScript","slug":"javascript"}],"tags":null,"author":{"name":"はにわまん","slug":"haniwaman"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"id":"42216f73-cc6e-5216-bddd-debe0ea2a165"}}}