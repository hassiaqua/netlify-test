{"componentChunkName":"component---src-templates-post-js","path":"/tel-link/","result":{"data":{"wordpressPost":{"id":"fff7678a-df08-5bb6-8e45-a9d293f37ef0","title":"スマホのみ電話番号をリンクにするJavaScript","slug":"tel-link","content":"<p><strong class=\"marker\">スマホのみ電話番号をリンクにする</strong>JavaScriptの書き方の紹介です。PCページに電話リンクがあると邪魔になるケースのほうが多いと思います。</p>\n<p>電話リンクを付けていても、PC時（スマホ以外）では無効化されるようにしておくと、ちょっとだけ親切なサイトになるかもしれません。</p>\n<div class=\"chat\"><figure class=\"chat-img\"><img src=\"https://haniwaman.com/wp-content/themes/hpcode/img/haniwa.png\" alt=\"\"><figcaption>はにわまん</figcaption></figure><div class=\"chat-content\">ユーザーエージェントで判定しています！</div></div>\n<div id=\"toc_container\" class=\"no_bullets\"><p class=\"toc_title\">目次</p><ul class=\"toc_list\"><li><a href=\"#i\"><span class=\"toc_number toc_depth_1\">1</span> ユーザーエージェントをチェックして条件を分ける</a><ul><li><a href=\"#Android\"><span class=\"toc_number toc_depth_2\">1.1</span> Androidの場合</a></li><li><a href=\"#iPhone\"><span class=\"toc_number toc_depth_2\">1.2</span> iPhoneの場合</a></li><li><a href=\"#iPad\"><span class=\"toc_number toc_depth_2\">1.3</span> iPadの場合</a></li></ul></li><li><a href=\"#AndroidiPhone\"><span class=\"toc_number toc_depth_1\">2</span> AndroidとiPhoneだけ電話リンクを有効にする</a></li><li><a href=\"#i-2\"><span class=\"toc_number toc_depth_1\">3</span> （おまけ）ブラウザ判定も可能</a><ul><li><a href=\"#i-3\"><span class=\"toc_number toc_depth_2\">3.1</span> ブラウザ判定をまとめると</a></li></ul></li><li><a href=\"#i-4\"><span class=\"toc_number toc_depth_1\">4</span> おわり</a></li></ul></div>\n<h2><span id=\"i\">ユーザーエージェントをチェックして条件を分ける</span></h2>\n<p>JavaScriptでは<code>navigator.userAgent</code>でユーザーエージェントを取得することが可能です。この値によって、<strong class=\"marker\">AndroindもしくはiPhoneからアクセスされているかどうかを判定</strong>して電話にリンクを設置するという方法になります。</p>\n<h3><span id=\"Android\">Androidの場合</span></h3>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-0\">コピー</span><code id=\"code-0\" class=\"js\">let ua = navigator.userAgent;\r\nif (ua.indexOf(\"Android\") &gt;= 0) {\r\n\tconsole.log( 'Androind' );\r\n}</code></pre>\n<p>Androind端末から<code>console.log( navigator.userAgent );</code>すると、以下のような値になります。</p>\n<blockquote><p>Mozilla/5.0 (Linux; Android 5.0; SM-G900P Build/LRX21T) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.120 Mobile Safari/537.36</p></blockquote>\n<p>上の文字列の中に「Android」の文字があるかどうかを<code>indexOf(\"Android\")</code>で調べています。文字列が見つからなければ<code>-1</code>となり、見つかれば見つかった位置の数字を返すため、<strong class=\"marker\">値が0以上であれば「Android」という文字が存在する</strong>という判定です。</p>\n<h3><span id=\"iPhone\">iPhoneの場合</span></h3>\n<p>iPhoneの場合もAndroindと同様です。ユーザーエージェントから「iPhone」の文字があるかどうかの判定を行います。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-1\">コピー</span><code id=\"code-1\" class=\"js\">let ua = navigator.userAgent;\r\nif (ua.indexOf(\"iPhone\") &gt;= 0) {\r\n\tconsole.log( 'iPhoneの場合' );\r\n}</code></pre>\n<p>iPhone端末から<code>console.log( navigator.userAgent );</code>すると、以下のような値になります。</p>\n<blockquote><p>Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_1 like Mac OS X) AppleWebKit/603.1.30 (KHTML, like Gecko) Version/10.0 Mobile/14E304 Safari/602.1</p></blockquote>\n<p>上の文字列の中に「iPhone」の文字があるかどうかを<code>indexOf(\"Android\")</code>で調べています。文字列が見つからなければ<code>-1</code>となり、見つかれば見つかった位置の数字を返すため、<strong class=\"marker\">値が0以上であれば「iPhone」という文字が存在する</strong>という判定です。</p>\n<h3><span id=\"iPad\">iPadの場合</span></h3>\n<p>AndroindとiPhoneの説明を見た方なら、もはや説明不要かと思いますが、一応iPadの場合も見てみましょう。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-2\">コピー</span><code id=\"code-2\" class=\"js\">let ua = navigator.userAgent;\r\nif (ua.indexOf(\"iPad\") &gt;= 0 ) {\r\n\tconsole.log( 'iPadの場合' );\r\n}</code></pre>\n<p>iPadでアクセスした時のユーザーエージェントは以下のような感じで、「iPad」の文字を探しています。</p>\n<blockquote><p>Mozilla/5.0 (iPad; CPU OS 11_0 like Mac OS X) AppleWebKit/604.1.34 (KHTML, like Gecko) Version/11.0 Mobile/15A5341f Safari/604.1</p></blockquote>\n<h2><span id=\"AndroidiPhone\">AndroidとiPhoneだけ電話リンクを有効にする</span></h2>\n<p>HTML上では、電話リンク（<code>a</code>タグ）がついている状態です。なので正確には、AndroidとiPhoneだけ電話リンクを有効にするというよりは、<strong class=\"marker\">AndroidとiPhone以外では電話リンクを無効にする</strong>、という表現の正しいかもしれません&#8230;</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-3\">コピー</span><code id=\"code-3\" class=\"js\">let ua = navigator.userAgent;\r\nif (ua.indexOf(\"iPhone\") === -1 &amp;&amp; ua.indexOf(\"Android\") === -1) {\r\n\tjQuery('a[href^=\"tel:\"]')\r\n\t\t.css(\"cursor\", \"default\")\r\n\t\t.on(\"click\", function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t});\r\n}</code></pre>\n<p>条件判定については既に解説しました。中の処理としては、すべての電話リンク（<code>a[href^=\"tel:\"]</code>）を対象に、まずは<strong class=\"marker\">カーソルを標準のものに変更してクリックイベント無効（クリックしても反応させない）</strong>という処理を行っています。</p>\n<p>とりあえず、これでクリックしても反応はしなくなりますが、もし他にクリック対象っぽい装飾がCSSでされている場合は、適宜無効にしてあげる必要はあるかもしれません。</p>\n<h2><span id=\"i-2\">（おまけ）ブラウザ判定も可能</span></h2>\n<p>スマホ時のみ電話リンクを機能させる処理は以上になるのですが、<strong class=\"marker\">ユーザーエージェントの値を取得できるとブラウザの判定もできるようになる</strong>ので、こちらもついでに見ていきましょう！</p>\n<p>まずは、それぞれのブラウザで取得できるユーザーエージェントの値は以下のような感じです。</p>\n<table class=\"table\">\n<tr>\n<th width=\"100\">Chrome</th>\n<td>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.120 Safari/537.36</td>\n</tr>\n<tr>\n<th>Firefox</th>\n<td>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:69.0) Gecko/20100101 Firefox/69.0</td>\n</tr>\n<tr>\n<th>Safari</th>\n<td>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.2 Safari/605.1.15</td>\n</tr>\n<tr>\n<th>IE11</th>\n<td>Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; .NET4.0C; .NET4.0E; Tablet PC 2.0; rv:11.0) like Gecko</td>\n</tr>\n<tr>\n<th>Edge</th>\n<td>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36 Edge/18.18362</td>\n</tr>\n</table>\n<h3><span id=\"i-3\">ブラウザ判定をまとめると</span></h3>\n<p>先ほどの結果を元にブラウザ判定をまとめると、以下のような感じです。ブラウザごとに微調整を加えたい時は以下の判定を使って調整することもできます。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-4\">コピー</span><code id=\"code-4\" class=\"js\">let ua = navigator.userAgent;\r\nif (ua.indexOf(\"Edge\") &gt; 0) {\r\n\tconsole.log( 'Edgeの場合' );\r\n} else if (ua.indexOf(\"Chrome\") &gt; 0) {\r\n\tconsole.log( 'Chromeの場合' );\r\n} else if (ua.indexOf(\"Safari\") &gt; 0) {\r\n\tconsole.log( 'Safariの場合' );\r\n} else if (ua.indexOf(\"Firefox\") &gt; 0) {\r\n\tconsole.log( 'Firefoxの場合' );\r\n} else if (ua.indexOf(\"Trident/7\") &gt; 0) {\r\n\tconsole.log( 'IE11の場合' );\r\n} else {\r\n\tconsole.log( 'その他のブラウザ' );\r\n}</code></pre>\n<h2><span id=\"i-4\">おわり</span></h2><div class=\"matome\"><div class=\"matome-img\"><img src=\"https://haniwaman.com/wp-content/themes/hpcode/img/haniwa.png\" alt=\"\"></div><div class=\"matome-twitter\"><a href=\"https://twitter.com/haniwa008?ref_src=twsrc%5Etfw\" class=\"twitter-follow-button\" data-show-screen-name=\"false\" data-size=\"large\" data-lang=\"ja\" data-show-count=\"true\">Follow @haniwa008</a><script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script></div></div><!-- /matome -->\n<p>スマホのみ電話番号をリンクにするJavaScriptの紹介と、ついでのおまけ的にブラウザを判定する方法でした。</p>\n<p>電話リンクをPCであると返って邪魔になる場合のほうが多いので、わたしは標準でスマホ以外の電話リンクは無効にするようにしています。</p>\n","date":"November 24, 2019","categories":[{"name":"JavaScript","slug":"javascript"}],"tags":null,"author":{"name":"はにわまん","slug":"haniwaman"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"id":"fff7678a-df08-5bb6-8e45-a9d293f37ef0"}}}