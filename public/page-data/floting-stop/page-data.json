{"componentChunkName":"component---src-templates-post-js","path":"/floting-stop/","result":{"data":{"wordpressPost":{"id":"68ea2599-b7ba-5a79-93b1-e6e662a00af9","title":"【jQuery】fixedで固定したフローティングアイテムをフッターの上で止める方法","slug":"floting-stop","content":"<p><strong class=\"marker\">フローティングアイテムをフッターの上で止める方法</strong>です。フッターと色が被ったりしてフッター上で止めるという実装もたまにやりたくなります。</p>\n<p>jQueryを使ってフッターの高さやスクロールの位置をゴリゴリと取得していくというやり方ですね&#8230;</p>\n<p>動きとしては以下のような感じになります。（右下の「トップへ」というボタンが固定されています）<br />\n<video src=\"https://haniwaman.com/wp-content/uploads/2019/07/floting-stop1.mov\" controls autoplay loop></video></p>\n<div class=\"chat\"><figure class=\"chat-img\"><img src=\"https://haniwaman.com/wp-content/themes/hpcode/img/haniwa.png\" alt=\"\"><figcaption>はにわまん</figcaption></figure><div class=\"chat-content\">位置や高さの取得はややこしくて混乱しがちですね...</div></div>\n<div id=\"toc_container\" class=\"no_bullets\"><p class=\"toc_title\">目次</p><ul class=\"toc_list\"><li><a href=\"#i\"><span class=\"toc_number toc_depth_1\">1</span> フローティングアイテムをフッターの上で止めるコード</a><ul><li><a href=\"#jQuery\"><span class=\"toc_number toc_depth_2\">1.1</span> jQueryの各種ポジション（位置）のおさらい</a></li></ul></li><li><a href=\"#i-2\"><span class=\"toc_number toc_depth_1\">2</span> フローティングアイテムを途中から表示する</a></li><li><a href=\"#i-3\"><span class=\"toc_number toc_depth_1\">3</span> おわり</a></li></ul></div>\n<h2><span id=\"i\">フローティングアイテムをフッターの上で止めるコード</span></h2>\n<p>それでは早速コードを書いていきます！HTMLとCSSで基本のコードを書きつつ、jQueryで処理を実装する感じになります。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-0\">コピー</span><code id=\"code-0\" class=\"html\">&lt;div class=\"floating\"&gt;\r\n  &lt;a href=\"#\"&gt;トップへ&lt;/a&gt;\r\n&lt;/div&gt;</code></pre>\n<p><code>body</code>から<code>absolute</code>を使いたいので指定してあげてください。別の要素でラップしてあげてもOKです。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-1\">コピー</span><code id=\"code-1\" class=\"css\">body {\r\n\tposition: relative;\r\n}\r\n\r\n.floating {\r\n\tposition: fixed;\r\n\tright: 10px;\r\n\tbottom: 10px;\r\n}\r\n\r\n.floating a {\r\n\tdisplay: block;\r\n\tcolor: #fff;\r\n\tbackground: #666;\r\n\tpadding: 8px;\r\n\ttext-decoration: none;\r\n}</code></pre>\n<p>トップへ戻るの実装方法は下記に記事と同様です。こちらの記事を参考にしていただければと思います。</p>\n<blockquote class=\"wp-embedded-content\" data-secret=\"McrzdQBhoU\"><p><a href=\"https://haniwaman.com/floating/\">スクロールの途中で出現するフローティングボタンのJavaScript</a></p></blockquote>\n<p><iframe title=\"&#8220;スクロールの途中で出現するフローティングボタンのJavaScript&#8221; &#8212; HPcode\" class=\"wp-embedded-content\" sandbox=\"allow-scripts\" security=\"restricted\" style=\"position: absolute; clip: rect(1px, 1px, 1px, 1px);\" src=\"https://haniwaman.com/floating/embed/#?secret=McrzdQBhoU\" data-secret=\"McrzdQBhoU\" width=\"500\" height=\"282\" frameborder=\"0\" marginwidth=\"0\" marginheight=\"0\" scrolling=\"no\"></iframe></p>\n<p>そして、下記のコードを加えることでフッターの高さを計算しつつ、<code>.floating</code>の要素が<code>#footer</code>の上で止まるような動きをしています。</p>\n<p>下記コードをそのまま使う場合はフローティングアイテムのクラスを<code>.floating</code>。フッターは<code>#footer</code>のidを指定してあげてください。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-2\">コピー</span><code id=\"code-2\" class=\"js\">jQuery(window).on(\"scroll\", function() {\r\n\tdocumentHeight = jQuery(document).height();\r\n\tscrollPosition = jQuery(this).height() + jQuery(this).scrollTop();\r\n\tfooterHeight = jQuery(\"#footer\").innerHeight();\r\n\r\n\tif (documentHeight - scrollPosition &lt;= footerHeight) {\r\n\t\tjQuery(\".floating\").css({\r\n\t\t\tposition: \"absolute\",\r\n\t\t\tbottom: footerHeight + 10\r\n\t\t});\r\n\t} else {\r\n\t\tjQuery(\".floating\").css({\r\n\t\t\tposition: \"fixed\",\r\n\t\t\tbottom: 10\r\n\t\t});\r\n\t}\r\n});</code></pre>\n<h3><span id=\"jQuery\">jQueryの各種ポジション（位置）のおさらい</span></h3>\n<ul>\n<li><code>jQuery(document).height()</code>・・・ページ全体の高さ</li>\n<li><code>jQuery(window).height() </code>・・・表示されているウインドウの高さ</li>\n<li><code>jQuery(window).scrollTop()</code>・・・（ページの一番上からの）スクロールの量</li>\n</ul>\n<p><code>jQuery(\"#footer\").innerHeight()</code>・・・フッターの高さ（paddingなども含めた高さです）</p>\n<p>今回jQueryで取得できる全体的な位置関係を一つにまとめると以下のようになります。<br />\n<img src=\"https://haniwaman.com/wp-content/uploads/2019/11/stop-before-footer1-700x749.png\" alt=\"\" width=\"700\" class=\"alignnone size-medium wp-image-16740\" srcset=\"https://haniwaman.com/wp-content/uploads/2019/11/stop-before-footer1-700x749.png 700w, https://haniwaman.com/wp-content/uploads/2019/11/stop-before-footer1-768x822.png 768w, https://haniwaman.com/wp-content/uploads/2019/11/stop-before-footer1.png 957w\" sizes=\"(max-width: 700px) 100vw, 700px\" /></p>\n<p>ページ全体の高さから、トップからのスクロール量を引いて、フッターの高さより小さくなるなら、<code>fixed</code>を止めるという処理を行っています。</p>\n<p>通常は、<code>fixed</code>で動かしつつ、フッターにかぶりそうになったら、<code>body</code>下からの<code>absolue</code>でフッターの高さ分を指定してあげて固定します。</p>\n<h2><span id=\"i-2\">フローティングアイテムを途中から表示する</span></h2>\n<p>スクロールイベントを使っているのでついでにフローティングアイテムをスクロールの途中から表示されるという処理もやっていきましょう。以下の記事で紹介しているヘッダーを途中から表示させる場合と同様の処理になります。</p>\n<blockquote class=\"wp-embedded-content\" data-secret=\"fw770DEeH6\"><p><a href=\"https://haniwaman.com/header-fixed/\">途中からヘッダー固定にする方法！画面上部までスクロールされたら固定する</a></p></blockquote>\n<p><iframe title=\"&#8220;途中からヘッダー固定にする方法！画面上部までスクロールされたら固定する&#8221; &#8212; HPcode\" class=\"wp-embedded-content\" sandbox=\"allow-scripts\" security=\"restricted\" style=\"position: absolute; clip: rect(1px, 1px, 1px, 1px);\" src=\"https://haniwaman.com/header-fixed/embed/#?secret=fw770DEeH6\" data-secret=\"fw770DEeH6\" width=\"500\" height=\"282\" frameborder=\"0\" marginwidth=\"0\" marginheight=\"0\" scrolling=\"no\"></iframe></p>\n<p>最初は非表示にしたいので、以下のcssを追加してあげます。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-3\">コピー</span><code id=\"code-3\" class=\"css\">.floating {\r\n\tdisplay: none;\r\n}</code></pre>\n<p>そして、スクロール量が100pxを超えたら表示させてあげる処理を加えます。</p>\n<pre><span class=\"code-copy\" data-clipboard-target=\"#code-4\">コピー</span><code id=\"code-4\" class=\"js\">jQuery(window).on(\"scroll\", function() {\r\n\tif (100 &lt; jQuery(this).scrollTop()) {\r\n\t\tjQuery(\".floating\").css({\r\n\t\t\tdisplay: \"block\",\r\n\t\t});\r\n\t} else {\r\n\t\tjQuery(\".floating\").css({\r\n\t\t\tdisplay: \"none\",\r\n\t\t});\r\n\t}\r\n});</code></pre>\n<p>これで、スクロールしたら表示されるという動きにすることができました。<br />\n<video src=\"https://haniwaman.com/wp-content/uploads/2019/07/floting-stop2.mov\" controls autoplay loop></video></p>\n<h2><span id=\"i-3\">おわり</span></h2><div class=\"matome\"><div class=\"matome-img\"><img src=\"https://haniwaman.com/wp-content/themes/hpcode/img/haniwa.png\" alt=\"\"></div><div class=\"matome-twitter\"><a href=\"https://twitter.com/haniwa008?ref_src=twsrc%5Etfw\" class=\"twitter-follow-button\" data-show-screen-name=\"false\" data-size=\"large\" data-lang=\"ja\" data-show-count=\"true\">Follow @haniwa008</a><script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script></div></div><!-- /matome -->\n<p><code>fixed</code>で固定したフローティングアイテムをフッターの上で止める方法でした。</p>\n<p>フッターの上に止めることもそうですが、画面上の位置を取得するjQueryの各種の値はゴチャゴチャして分かりにくいですが、、、使えるようになっておくとちょっとしたイレギュラーな動きを付ける時に重宝したりします。</p>\n","date":"July 10, 2019","categories":[{"name":"JavaScript","slug":"javascript"}],"tags":null,"author":{"name":"はにわまん","slug":"haniwaman"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"id":"68ea2599-b7ba-5a79-93b1-e6e662a00af9"}}}